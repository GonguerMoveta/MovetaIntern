CREATE VIEW VAUFTRAG(AuftrNr, AuftrPosNr, KdNr, AuftrArt, ArtNr, KdArtNr, RestMenge, Geliefert, PosMenge,Abrufmenge,BestNrFremd,Typ,PosVK,NettoBetrag, StaffelVk,Liefertermin, Versandtermin,Wunschtermin,Freigabekz,Vertreter,Provsatz,MengenEinheit,PreisEinheit,Status, TerminKz, NrKreisNr, WerkNrEigen) AS SELECT P.AuftrNr, P.AuftrPosNr, K.KdNr, K.AuftrArt, P.ArtNr, P.KdArtNr, @if(T.Teilmenge,T.Teilmenge,P.Menge-@NULLVALUE(P.LieferMenge,0)), P.Liefermenge,P.Menge, P.Abrufsumme, @if(@ISNA(T.BestnrFremd),P.BestnrFremd,T.BestnrFremd), @DECODE(T.Typ,'B','StaffelOffen','A','StaffelGeliefert','Position'), P.VK,P.NettoBetrag, T.VK, @if(@ISNA(T.Typ),P.Lieftermin,@DECODE(T.Typ,'B',T.BestellDatum,T.Lieferdatum)), @if(@ISNA(T.Typ),P.Versandzeit,T.Versandzeit), @if(@ISNA(T.Typ),P.KdWuTermin,T.Wunschdatum), @if(@ISNA(T.Typ),P.Freigabekz,T.Kennzeichen), P.Vertnr1,P.Vertprovanteil1, P.Mengeeinh,P.Preiseinh,P.Status, T.TerminKz,K.NrKreisNr, K.WerkNrEigen FROM Auftrag K, Auftrpos P, Termstaffaufpos T WHERE K.AuftrNr = P.AuftrNr AND P.AuftrNr = T.AuftrNr(+) AND P.AuftrPosNr = T.AuftrPosNr(+);
CREATE VIEW MONAUFAE(ArtNr,KdNr,Vertreter1,Vertreter2,Gesamt,Jan,Feb,Mrz, Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,Rechnr,LiefNr,Aufnr,Nettoeinzel, NrKreisNr,WerkNrEigen) AS SELECT ArtNr,KdNr,Vertreter1,Vertreter2, Gesamtnettowert, Gesamtnettowert * @IF(@MONTH(Datum)-1,0,1), Gesamtnettowert * @IF(@MONTH(Datum)-2,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-3,0,1), Gesamtnettowert * @IF(@MONTH(Datum)-4,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-5,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-6,0,1), Gesamtnettowert * @IF(@MONTH(Datum)-7,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-8,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-9,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-10,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-11,0,1) , Gesamtnettowert * @IF(@MONTH(Datum)-12,0,1) , @MONTH(Datum), @YEARNO(Datum), Datum,NULL,NULL,Auftragsnr, Nettopreis, NrKreisNr, WerkNrEigen FROM Auftragseingang;
CREATE VIEW MONAEMENGEN(ArtNr,KdNr,Vertreter1,Vertreter2,Gesamt,Jan,Feb,Mrz,Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,Rechnr,LiefNr,Aufnr, NrKreisNr,WerkNrEigen, Lagermenge,LagerJan,LagerFeb,LagerMrz, LagerApr,LagerMai,LagerJun,LagerJul,LagerAug,LagerSept,LagerOkt,LagerNov,LagerDez) AS SELECT ArtNr,KdNr,Vertreter1,Vertreter2,Menge, Menge * @IF(@MONTH(Datum)-1,0,1), Menge * @IF(@MONTH(Datum)-2,0,1), Menge * @IF(@MONTH(Datum)-3,0,1), Menge * @IF(@MONTH(Datum)-4,0,1), Menge * @IF(@MONTH(Datum)-5,0,1), Menge * @IF(@MONTH(Datum)-6,0,1), Menge * @IF(@MONTH(Datum)-7,0,1), Menge * @IF(@MONTH(Datum)-8,0,1), Menge * @IF(@MONTH(Datum)-9,0,1), Menge * @IF(@MONTH(Datum)-10,0,1), Menge * @IF(@MONTH(Datum)-11,0,1), Menge * @IF(@MONTH(Datum)-12,0,1), @MONTH(Datum), @YEARNO(Datum), Datum,NULL,NULL,Auftragsnr, NrKreisNr, WerkNrEigen, LagerMenge, LagerMenge * @IF(@MONTH(Datum)-1,0,1), LagerMenge * @IF(@MONTH(Datum)-2,0,1), LagerMenge * @IF(@MONTH(Datum)-3,0,1), LagerMenge * @IF(@MONTH(Datum)-4,0,1), LagerMenge * @IF(@MONTH(Datum)-5,0,1), LagerMenge * @IF(@MONTH(Datum)-6,0,1), LagerMenge * @IF(@MONTH(Datum)-7,0,1), LagerMenge * @IF(@MONTH(Datum)-8,0,1), LagerMenge * @IF(@MONTH(Datum)-9,0,1), LagerMenge * @IF(@MONTH(Datum)-10,0,1), LagerMenge * @IF(@MONTH(Datum)-11,0,1), LagerMenge * @IF(@MONTH(Datum)-12,0,1) FROM Auftragseingang;
CREATE VIEW MONSTAT(ArtNr,Kundnr,Vertreter1,Vertreter2,Gesamt,Jan,Feb,Mrz, Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,Rechnr,LiefNr,Aufnr,Nettoeinzel, Menge, LieferKz, MengeJan, MengeFeb, MengeMrz,MengeApr, MengeMai, MengeJun, MengeJul, MengeAug, MengeSept, MengeOkt, MengeNov, MengeDez, AufPosNr,PROVSATZ1, PROVSATZ2,NrKreisNr, WerkNrEigen, ERLOESKONTO, LagerMenge, LagerMengeJan, LagerMengeFeb, LagerMengeMrz,LagerMengeApr, LagerMengeMai, LagerMengeJun, LagerMengeJul, LagerMengeAug, LagerMengeSept, LagerMengeOkt, LagerMengeNov, LagerMengeDez ) AS SELECT ArtNr,Kundnr,Vertreter1,Vertreter2, Gesamtnetto , Gesamtnetto * @IF(@MONTH(Datum)-1,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-2,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-3,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-4,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-5,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-6,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-7,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-8,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-9,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-10,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-11,0,1) , Gesamtnetto * @IF(@MONTH(Datum)-12,0,1) , @MONTH(Datum), @YEARNO(Datum), Datum,RechnungsNr,LiefNr,Auftrnr, Nettoeinzel, @DECODE(Lieferkz, 'G', Menge * -1, Menge ), LieferKz, @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-1,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-2,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-3,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-4,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-5,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-6,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-7,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-8,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-9,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-10,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-11,0,1) , @DECODE(Lieferkz, 'G', Menge * -1, Menge ) * @IF(@MONTH(Datum)-12,0,1), AuftrPosNr, PROVSATZ1, PROVSATZ2,NrKreisNr, WerkNrEigen, ERLOESKONTO, @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ), @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-1,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-2,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-3,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-4,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-5,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-6,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-7,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-8,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-9,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-10,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-11,0,1) , @DECODE(Lieferkz, 'G', LagerMenge * -1, LagerMenge ) * @IF(@MONTH(Datum)-12,0,1) FROM Vkstatdetail;
CREATE VIEW VZUSCHLAUFPOS(auftrnr, auftrposnr, betrag, proz) AS SELECT auftrnr, auftrposnr, sum(@NULLVALUE(zuschprozsatz,0)) , sum(@IF(@isna(zuschprozsatz),0,zuschprozsatz/100)) FROM ZUSCHLAUFPOS WHERE berechnet !='1' AND (zuschprozsatz != 0 OR zuschbetrag != 0) GROUP BY auftrnr, auftrposnr;
CREATE VIEW MONAUFAB(ArtNr,KdNr,Vertreter1,Vertreter2,Gesamt,Jan,Feb,Mrz, Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,Rechnr,LiefNr,Aufnr,Nettoeinzel,Versandzeit,Erloeskto,NrKreisNr,WerkNrEigen) AS SELECT ArtNr,KdNr,Vertnr1,Vertnr2, Gesamtnetto, Gesamtnetto * @IF(@MONTH(Versandzeit)-1,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-2,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-3,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-4,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-5,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-6,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-7,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-8,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-9,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-10,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-11,0,1), Gesamtnetto * @IF(@MONTH(Versandzeit)-12,0,1), @MONTH(Versandzeit), @YEARNO(Versandzeit), Versandzeit,NULL,NULL,Auftrnr,Nettoeinzel,Versandzeit,Erloeskto,NrKreisNr,WerkNrEigen FROM TAuftrag;
CREATE VIEW MONABMENGEN(ArtNr,KdNr,Vertreter1,Vertreter2,Gesamt,Jan,Feb,Mrz, Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,Rechnr,LiefNr,Aufnr,Nettoeinzel,Erloeskto,NrKreisNr,WerkNrEigen,Lagermenge,LagerJan,LagerFeb,LagerMrz, LagerApr,LagerMai,LagerJun,LagerJul,LagerAug,LagerSept,LagerOkt,LagerNov,LagerDez ) AS SELECT ArtNr,KdNr,Vertnr1,Vertnr2,Menge, Menge * @IF(@MONTH(Versandzeit)-1,0,1), Menge * @IF(@MONTH(Versandzeit)-2,0,1), Menge * @IF(@MONTH(Versandzeit)-3,0,1), Menge * @IF(@MONTH(Versandzeit)-4,0,1), Menge * @IF(@MONTH(Versandzeit)-5,0,1), Menge * @IF(@MONTH(Versandzeit)-6,0,1), Menge * @IF(@MONTH(Versandzeit)-7,0,1), Menge * @IF(@MONTH(Versandzeit)-8,0,1), Menge * @IF(@MONTH(Versandzeit)-9,0,1), Menge * @IF(@MONTH(Versandzeit)-10,0,1), Menge * @IF(@MONTH(Versandzeit)-11,0,1), Menge * @IF(@MONTH(Versandzeit)-12,0,1), @MONTH(Versandzeit), @YEARNO(Versandzeit), Versandzeit,NULL,NULL,Auftrnr,Nettoeinzel,Erloeskto,NrKreisNr,WerkNrEigen, LagerMenge, LagerMenge * @IF(@MONTH(Versandzeit)-1,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-2,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-3,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-4,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-5,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-6,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-7,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-8,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-9,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-10,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-11,0,1), LagerMenge * @IF(@MONTH(Versandzeit)-12,0,1) FROM TAuftrag;
CREATE VIEW MONWE(ArtNr,LieferantNr,Gesamt,Jan,Feb,Mrz,Apr,Mai, Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,EinRechNr,BestNr, NettoEinzel,AfoNr,Status,ArbGangKuerzel,Menge,DfueKz,MengeEinh, AuftragsTyp,WkzArtNr,BAKdNr,BAKdPosNr,EK,PreisEinh,WareneingangsNr,NrKreisNr, WerkNrEigen,EkStatDetNr,RueckLSNr,RueckLSPosNr,OhneBEPR)AS SELECT ArtNr,LieferantNr, Nettosumme, Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-1,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-2,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-3,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-4,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-5,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-6,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-7,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-8,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-9,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-10,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-11,0,1) , Nettosumme * @IF(@MONTH(@NULLVALUE(Rechdatum,Eingangsdat))-12,0,1) , @MONTH(@NULLVALUE(Rechdatum,Eingangsdat)), @YEARNO(@NULLVALUE(Rechdatum,Eingangsdat)), @NULLVALUE(Rechdatum,Eingangsdat), EinRechNr, BestNr, @NULLVALUE(Preis / @NULLVALUE(@DECODE(PruefPreisEinh,0,1,PruefPreisEinh),1),Nettoeinzel), AfoNr, Status, ArbgangKuerzel, Menge, DfueKz, MengeEinh, AuftragsTyp, WkzArtNr, BAKdNr, BAKdPosNr, @NULLVALUE(Preis,(NettoEinzel*PreisEinh)), @NULLVALUE(PruefPreisEinh,PreisEinh), WareneingangsNr, NrKreisNr, WerkNrEigen, EkStatDetNr, RueckLSNr, RueckLSPosNr, OhneBEPR FROM Ekstatdetail;
CREATE VIEW MONWEMENGEN(ArtNr,LieferantNr,Gesamt,Jan,Feb,Mrz,Apr,Mai, Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,EinRechNr,BestNr,AfoNr, Status,ArbGangKuerzel,DfueKz,MengeEinh,AuftragsTyp,WkzArtNr,BAKdNr,BAKdPosNr, EK,PreisEinh,WareneingangsNr,NrKreisNr,WerkNrEigen,EkStatDetNr,RueckLSNr,RueckLSPosNr,OhneBEPR) AS SELECT Artnr,Lieferantnr,Menge, Menge * @IF(@MONTH(Eingangsdat)-1,0,1), Menge * @IF(@MONTH(Eingangsdat)-2,0,1), Menge * @IF(@MONTH(Eingangsdat)-3,0,1), Menge * @IF(@MONTH(Eingangsdat)-4,0,1), Menge * @IF(@MONTH(Eingangsdat)-5,0,1), Menge * @IF(@MONTH(Eingangsdat)-6,0,1), Menge * @IF(@MONTH(Eingangsdat)-7,0,1), Menge * @IF(@MONTH(Eingangsdat)-8,0,1), Menge * @IF(@MONTH(Eingangsdat)-9,0,1), Menge * @IF(@MONTH(Eingangsdat)-10,0,1), Menge * @IF(@MONTH(Eingangsdat)-11,0,1), Menge * @IF(@MONTH(Eingangsdat)-12,0,1), @MONTH(Eingangsdat), @YEARNO(Eingangsdat), Eingangsdat, EinRechnr, Bestnr, AfoNr, Status, ArbgangKuerzel, DfueKz, MengeEinh, AuftragsTyp, WkzArtNr, BAKdNr, BAKdPosNr, @NULLVALUE(Preis,(Nettoeinzel*PreisEinh)), @NULLVALUE(PruefPreisEinh,PreisEinh), Wareneingangsnr, NrKreisNr, WerkNrEigen, EkStatDetNr, RueckLSNr, RueckLSPosNr,OhneBEPR FROM Ekstatdetail;
CREATE VIEW MONBESTBEST(ArtNr,LieferantNr,Gesamt,Jan,Feb,Mrz,Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,EinRechNr,BestNr,BestPosNr,NettoEinzel,AuftragsTyp,WkzArtNr,BAKdNr,BAKdPosNr,EK,PreisEinh,NrKreisNr,WerkNrEigen) AS SELECT Artnr,Lieferantnr, Gesamtnetto, Gesamtnetto * @IF(@MONTH(Datum)-1,0,1), Gesamtnetto * @IF(@MONTH(Datum)-2,0,1), Gesamtnetto * @IF(@MONTH(Datum)-3,0,1), Gesamtnetto * @IF(@MONTH(Datum)-4,0,1), Gesamtnetto * @IF(@MONTH(Datum)-5,0,1), Gesamtnetto * @IF(@MONTH(Datum)-6,0,1), Gesamtnetto * @IF(@MONTH(Datum)-7,0,1), Gesamtnetto * @IF(@MONTH(Datum)-8,0,1), Gesamtnetto * @IF(@MONTH(Datum)-9,0,1), Gesamtnetto * @IF(@MONTH(Datum)-10,0,1), Gesamtnetto * @IF(@MONTH(Datum)-11,0,1), Gesamtnetto * @IF(@MONTH(Datum)-12,0,1), @MONTH(Datum), @YEARNO(Datum),Datum,NULL,BestNr,BestPosNr,Nettoeinzel,AuftragsTyp,WkzArtNr,BAKdNr,BAKdPosNr, EK,PreisEinh,NrKreisNr,WerkNrEigen FROM TBestellung ;
CREATE VIEW MONBBMENGEN(ArtNr,LieferantNr,Gesamt,Jan,Feb,Mrz,Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,EinRechNr,BestNr,BestPosNr,NettoEinzel,AuftragsTyp,WkzArtNr,BAKdNr,BAKdPosNr,EK,PreisEinh,NrKreisNr,WerkNrEigen)AS SELECT Artnr,Lieferantnr,Menge, Menge * @IF(@MONTH(Datum)-1,0,1), Menge * @IF(@MONTH(Datum)-2,0,1), Menge * @IF(@MONTH(Datum)-3,0,1), Menge * @IF(@MONTH(Datum)-4,0,1), Menge * @IF(@MONTH(Datum)-5,0,1), Menge * @IF(@MONTH(Datum)-6,0,1), Menge * @IF(@MONTH(Datum)-7,0,1), Menge * @IF(@MONTH(Datum)-8,0,1), Menge * @IF(@MONTH(Datum)-9,0,1), Menge * @IF(@MONTH(Datum)-10,0,1), Menge * @IF(@MONTH(Datum)-11,0,1), Menge * @IF(@MONTH(Datum)-12,0,1), @MONTH(Datum), @YEARNO(Datum),Datum,NULL,BestNr,BestPosNr,Nettoeinzel, AuftragsTyp,WkzArtNr,BAKdNr,BAKdPosNr,EK,PreisEinh,NrKreisNr,WerkNrEigen FROM TBestellung;
CREATE VIEW VBESTELLUNG(BestNr, BestPosNr, LieferantNr, BestellArt, ArtNr, ArtNrLief, RestMenge, Geliefert, PosMenge,Abrufmenge,Typ,PosEk,NettoBetrag, StaffelEk,Liefertermin,BestaetigtTermin,MengenEinheit,PreisEinheit,Status,NrKreisNr,WerkNrEigen)AS SELECT P.BestNr, P.BestPosNr, K.LieferantNr, K.BestellArt, P.ArtNr, P.ArtNrLief,@if(T.Teilmenge,T.Teilmenge,P.Menge-@NULLVALUE(P.Geliefert,0)), P.Geliefert,P.Menge, P.Abrufsumme, @DECODE(T.Typ,'B','StaffelOffen','A','StaffelGeliefert','Position'), P.EK,P.NettoBetrag, T.EK, @if(@ISNA(T.Typ),P.LiefDatum,@DECODE(T.Typ,'B',T.BestellDatum,T.Datum)), @if(@ISNA(T.Typ),P.LiefDatBestaetigt,T.Bestelldatum), P.Mengeeinh,P.Preiseinh,P.Status, K.NrKreisNr, K.WerkNrEigen FROM BestKo K, BestPos P, TermStaffBestPos T WHERE K.BestNr = P.BestNr AND P.BestNr = T.BestNr(+) AND P.BestPosNr = T.BestPosNr(+);
CREATE VIEW MONLIEF (ArtNr,KdNr,Vertreter1,Vertreter2,Gesamt,Jan,Feb,Mrz, Apr,Mai,Jun,Jul,Aug,Sept,Okt,Nov,Dez,Mon,Jahr,Datum,Rechnr,LiefNr,Aufnr, NrKreisNr,WerkNrEigen) AS SELECT ArtNr,Kundnr,Vertreter1,Vertreter2,Menge, Menge * @IF(@MONTH(Liefdat)-1,0,1), Menge * @IF(@MONTH(Liefdat)-2,0,1), Menge * @IF(@MONTH(Liefdat)-3,0,1), Menge * @IF(@MONTH(Liefdat)-4,0,1), Menge * @IF(@MONTH(Liefdat)-5,0,1), Menge * @IF(@MONTH(Liefdat)-6,0,1), Menge * @IF(@MONTH(Liefdat)-7,0,1), Menge * @IF(@MONTH(Liefdat)-8,0,1), Menge * @IF(@MONTH(Liefdat)-9,0,1), Menge * @IF(@MONTH(Liefdat)-10,0,1), Menge * @IF(@MONTH(Liefdat)-11,0,1), Menge * @IF(@MONTH(Liefdat)-12,0,1), @MONTH(Liefdat), @YEARNO(Liefdat), Liefdat,RechnungsNr,LiefNr,auftrnr, NrKreisNr, WerkNrEigen FROM vkstatdetail UNION SELECT ArtNr,KdNr,l.vertnr1,l.vertnr2,Menge, Menge * @IF(@MONTH(lieferDatum)-1,0,1), Menge * @IF(@MONTH(lieferDatum)-2,0,1), Menge * @IF(@MONTH(lieferDatum)-3,0,1), Menge * @IF(@MONTH(lieferDatum)-4,0,1), Menge * @IF(@MONTH(lieferDatum)-5,0,1), Menge * @IF(@MONTH(lieferDatum)-6,0,1), Menge * @IF(@MONTH(lieferDatum)-7,0,1), Menge * @IF(@MONTH(lieferDatum)-8,0,1), Menge * @IF(@MONTH(lieferDatum)-9,0,1), Menge * @IF(@MONTH(lieferDatum)-10,0,1), Menge * @IF(@MONTH(lieferDatum)-11,0,1), Menge * @IF(@MONTH(lieferDatum)-12,0,1), @MONTH(LieferDatum), @YEARNO(LieferDatum), LieferDatum,0,l.LiefNr,l.AuftrNr, K.NrKreisNr, K.WerkNrEigen FROM Liefpos l, Lieferung k WHERE l.LiefNr = k.LiefNr AND k.Status ='LSgedruckt' and k.lieferungsart !='O' ;
CREATE VIEW VVERTDATUM (Vertreter, Datum, Matchcode, KdNr, KdMatchcode, NrKreisNr, WerkNrEigen) AS SELECT V.VertNr, A.Datum, V.Matchcode, A.KdNr, K.Matchcode, A.NrKreisNr, A.WerkNrEigen FROM AUFTRAG A, VERTRETER V, Kunde K WHERE (A.VertNr1 =V.VertNr OR A.VertNr2 =V.VertNr) AND A.KdNr = K.KdNr UNION ALL SELECT V.VertNr, S.AuftDat, V.Matchcode, S.KundNr, K.Matchcode ,S.NrKreisNr, S.WerkNrEigen FROM VkStatDetail S, Vertreter V, Kunde K WHERE (S.Vertreter1 =V.VertNr OR S.Vertreter2 = V.VertNr) AND S.KundNr = K.KdNr;
CREATE VIEW VVertList(KdNr, KMatchcode,KName1,KName2, KStrasse,KOrtPlz, KOrt, KFax, KTelefon, GesamtNetto, Jahr,LandNr, VertNr, VMatchcode, VName1, VName2, KTyp, NrKreisNr,WerkNrEigen)AS SELECT K.KdNr, K.Matchcode , K.Name1,K.Name2, K.Strasse, K.OrtPlz, K.Ort, K.Fax, K.Telefon, GesamtNetto, (@YEARNO(DATUM)),K.LandNr, V.VertNr,V.Matchcode, V.Name1,V.Name2, K.Typ, S.NrKreisNr, S.WerkNrEigen FROM KundVert U, Kunde K, vkstatdetail S, vertreter V WHERE U.KundNr = K.KdNr AND V.VertNr = U.VertNr AND K.KdNr = S.KundNr(+);
CREATE VIEW VLandLIST(KdNr, Matchcode, Name1,Name2, Strasse,OrtPlz, Ort, Fax,Telefon, GesamtNetto, Jahr, LandNr, KTyp, NrKreisNr,WerkNrEigen) AS SELECT K.KdNr, K.Matchcode , K.Name1,K.Name2, K.Strasse,K.OrtPlz, K.Ort, K.Fax,K.Telefon, S.GesamtNetto, (@YEARNO(S.DATUM)),K.LandNr, K.Typ, S.NrKreisNr, S.WerkNrEigen FROM Kunde K, VkStatDetail S WHERE K.KdNr = S.KundNr(+);
CREATE VIEW VKdGrList(KdGrNr,KdNr, KMatchcode,KName1,KName2, KStrasse,KOrtPlz, KOrt, KFax, KTelefon, GesamtNetto, Jahr,LandNr,KTyp, NrKreisNr,WerkNrEigen) AS SELECT K.KdGrupNr, K.KdNr, K.Matchcode, K.Name1,K.Name2, K.Strasse, K.OrtPlz, K.Ort, K.Fax, K.Telefon, S.GesamtNetto, (@YEARNO(S.DATUM)),K.LandNr, K.Typ, S.NrKreisNr,S.WerkNrEigen FROM Kunde K, VkStatDetail S WHERE K.KdNr = S.KundNr(+);
CREATE VIEW VLSFEINABRUF(LiefNr, LiefPosNr, AuftrNr, AuftrPosNr, Teilmenge, OffeneMenge, Bestelldatum, Lieferdatum, NrKreisNr, WerkNrEigen) AS SELECT LS.LiefNr, LS.Liefposnr, LS.Auftrnr, LS.Auftrposnr, LS.Teilmenge, F.Teilmenge, LS.Bestelldatum, L.Lieferdatum, L.NrKreisNr, L.WerkNrEigen FROM LSFEINABRUF LS, FEINABRUFSTAFFEL F, LIEFERUNG L WHERE F.AuftrNr(+)= LS.AuftrNr AND F.AuftrposNr(+)= LS.AuftrPosNr AND F.LfdNr(+)= LS.LfdStaffelNr AND L.LiefNr = LS.LiefNr;
CREATE VIEW VARTKUND AS SELECT DISTINCT KDNR, ARTNR FROM ARTKUND;
CREATE VIEW VAUFTRPOS(AUFTRNR,AUFTRPOSNR,KDNR,ARTNR,STATUS, MengeEinh, NrKreisNr,WerkNrEigen) AS SELECT P.AuftrNr, P.AuftrPosNr, K.KdNr, P.ArtNr, P.Status, P.MengeEinh, K.NrKreisNr,K.WerkNrEigen FROM Auftrag K, Auftrpos P WHERE K.AuftrNr = P.AuftrNr;
CREATE VIEW BAQUANTUMOMC (BANR, BAPOSNR, ARTNR, KDNR, KDAUFNR, KDAUFPOSNR, BETRMITTELNR, ARBPLNR, FREIGABEKZ, STATUS, FARBE ) AS SELECT @STRING(B.BETAUFNR,0), @STRING(B.BETAUFPOSNR,0), B.ARTNR, @STRING(B.KDNR,0), @STRING(B.KDAUFTRNR,0), @STRING(B.KDAUFTRPOS,0), S.BETRMITTELNR, P.ARBPLNR, B.FREIGABEKZ, B.STATUS, @MID(B.ARTNR, 13, 6) FROM BETRAUFTR B, ARBPLAPOBA P, SPRITZWKZBA S WHERE B.BETAUFNR = S.BETAUFNR(+) AND B.BETAUFPOSNR = S.BETAUFPOSNR(+) AND B.BETAUFNR = P.BETAUFNR AND B.BETAUFPOSNR = P.BETAUFPOSNR AND (P.ENGPASS = '1' AND B.FREIGABEKZ = '1' AND NOT B.STATUS = 'erledigt' ) ;
CREATE VIEW BAQUANTUMOKDBENR ( BANR, BAPOSNR, ARTNR, KDNR, KDMC, KDAUFNR, KDAUFPOSNR, BETRMITTELNR, ARBPLNR, FREIGABEKZ, STATUS, FARBE )AS SELECT B.BANR, B.BAPOSNR, B.ARTNR, B.KDNR, K.MATCHCODE, B.KDAUFNR, B.KDAUFPOSNR, B.BETRMITTELNR, B.ARBPLNR, B.FREIGABEKZ, B.STATUS, B.FARBE FROM BAQUANTUMOMC B, KUNDE K WHERE B.KDNR = K.KDNR(+) ;
CREATE VIEW BAQUANTUM ( BANR, BAPOSNR, ARTNR, KDNR, KDMC, KDAUFNR, KDAUFPOSNR, BETRMITTELNR, ARBPLNR, FREIGABEKZ, STATUS, FARBE, KDARTNR, KDBESTRFREMD ) AS SELECT B.BANR, B.BAPOSNR, @LEFT(B.ARTNR,12), B.KDNR, B.KDMC, B.KDAUFNR, B.KDAUFPOSNR, B.BETRMITTELNR, B.ARBPLNR, B.FREIGABEKZ, B.STATUS, B.FARBE, P.KDARTNR, @LEFT(P.BESTNRFREMD,32) FROM BAQUANTUMOKDBENR B, AUFTRPOS P WHERE B.KDAUFNR = P.AUFTRNR(+) AND B.KDAUFPOSNR = P.AUFTRPOSNR(+);
CREATE VIEW VLSKARTON (HERKUNFT, Sendungsnr, VERPACKNR, ANZBHV, Menge,Index1,TYP, KARTONNR, LAKARTONNR, LIEFNR, LIEFPOSNR, ARTNR, VPSTULINR,ANZVERPACK, PALNR, LADEEINHEIT, VERPACKUNGSTEXT, CHARGENNR ) AS select 1, LK1.Sendungsnr, K.VERPACKNR, K.ANZBHV, K.Menge, K.Index1, @DECODE(A1.DFUEVERPLABEL,0,@DECODE(K.Labelkz,'S',2,'M',1,2), 4,@DECODE(K.Labelkz,'S',2,'M',1,2) ,A1.DFUEVERPLABEL), @NULLVALUE(K.verpacktmitkarton,K.Kartonnr), K.LAKARTONNR, K.LIEFERNR, K.LIEFERPOSNR, K.ARTNR, K.VPSTULINR, 0,@NULLVALUE( K.PALNR, -99999999), a1.ladeeinheit, a1.Verpackungstext,K.CHARGENNR FROM lskarton K, ARTIKEL A1, Firmenpara FP1, lieferung LK1 Where LK1.Lieferdatum >= (SYSDATE -300) and LK1.Liefnr=K.Liefernr and fp1.parakey = 'DFUELS' and (( fp1.int2 = 1 and a1.Verpackungstext is not null ) or (int2!=1)) and K.VERPACKNR=A1.Artnr and A1.DFUEVERPLABEL!= 5 and ( @NULLVALUE(a1.ladeeinheit, '0') in (SELECT @NULLVALUE(MAX(a3.ladeeinheit), '0') from artikel a3, paletten p2 where a3.artnr = p2.artnr and A3.DFUEVERPLABEL!= 5 and p2.liefnr = k.liefernr and p2.liefposnr =k.lieferposnr) or a1.ladeeinheit='1') union all select 2, LK2.Sendungsnr, P.Artnr, P.ANZBHV, P.Palmenge, '', @DECODE(@NULLVALUE(P.ANZVERPACK,0),0,3,@DECODE(A2.DFUEVERPLABEL,0,@DECODE(P.Labelkz,'S',2,'M',1,1), 4,@DECODE(P.Labelkz,'S',2,'M',1,1), A2.DFUEVERPLABEL)), P.LFDNR, @NULLVALUE(P.PACKSTUECKNR,P.LFDNR) , P.LIEFNR, P.LIEFPOSNR, L.ARTNR,P.VPSTULINR, @NULLVALUE(P.ANZVERPACK,9999999999), @NULLVALUE( P.PALNR, -99999999), a2.ladeeinheit, a2.Verpackungstext,'' FROM paletten P, Artikel A2, LIEFPOS L, Firmenpara FP2, lieferung LK2 WHERE LK2.Lieferdatum >= (SYSDATE -300) and LK2.Liefnr=P.Liefnr and fp2.parakey = 'DFUELS' and (( fp2.int2 = 1 and a2.Verpackungstext is not null ) or (int2!=1)) and P.Artnr=A2.Artnr AND A2.DFUEVERPLABEL!= 5 AND L.LIEFNR = P.LIEFNR AND L.LIEFPOSNR = P.LIEFPOSNR and (@NULLVALUE(a2.ladeeinheit,'0') in (SELECT @NULLVALUE(MAX(a4.ladeeinheit), '0') from artikel a4, paletten p3 where a4.artnr = p3.artnr and A4.DFUEVERPLABEL!= 5 and p3.liefnr = P.liefnr and p3.liefposnr = p.liefposnr) or a2.ladeeinheit='1');
CREATE VIEW VVKSTATDETAILSUM ( GESAMTNETTO, LIEFNR) AS SELECT SUM(GesamtNetto) , LiefNr FROM VkStatDetail GROUP BY LiefNr;
create VIEW VLSKARTONGW (LGNettoGew, LGLiefnr, LGLiefposNr ) As SELECT SUM(NettoGew) , LieferNr, Lieferposnr FROM LSKARTON GROUP BY LieferNr, Lieferposnr;
CREATE VIEW VZOLLKOPF (HVERSION, HSENDNR,HLIEFNR, HRECHNR, HREDAT, HKDNR, HKUIDNR, HKNAME1, HKNAME2 , HKNAME3, HKSTRASSE, HKPLZ, HKORT, HKLAND, HKLAINTRA, HKTELEFON, HKFAX, HKEMAIL, HLKDNR, HLUIDNR, HLNAME1, HLNAME2, HLNAME3, HLSTRASSE, HLPLZ, HLORT, HLLAND, HLLAINTRA, HLTELEFON, HLFAX, HLEMAIL, HVERART, HZAHLB, HRNETTOHW, HRNETTOFW, HRWAERUNG, HRKURS, HRGEWBRUTTO, HRGEWNETTO, HSPEDNR, HSNAME1, HSSTRASSE, HSPLZ, HSORT, HSLANDNR, HSLAINTRA, HSTELEFON, HSFAX, HSEMAIL, HRFRACHTKOST, HRVERPACKKOST, HRVERSICHKOST, HRZOLLKOST, HRSONSTIGEKOST, HRMWSTBETR, HRMWSTSATZ, HREINTREFFDAT, HREINTREFFZT, HRVORTEXT, HRSCHLTEXT,HLIEFBEDNR,HINCOTERM ) AS select '1.50', l.sendungsnr, l.LIEFNR, l.rechnr, l.rechdatum, l.kdnr, KD.EGID, l.name1, l.name2, l.name3, l.strasse, l.ORTPLZ, l.ort, l.landnr, LA.INTRANR, l.telefonnr, l.faxnr , l.telexnr, l.kdnr, KD.EGID, l.liefname1, l.liefname2, l.liefname3, l.Liefstrasse, l.LiefORTPLZ, l.Liefort, l.Lieflandnr, LA2.INTRANR, l.lieftelefonnr, l.lieffaxnr, l.lieftelexnr, l.VERSANDART, ZB.Text , VD.GESAMTNETTO, LF.NETTOBETR, l.waehrung, l.kurs, LP.BRUTTOGEW, LP.NETTOGEW, LP.Speditionnr, SP.NAME, SP.STRASSE, SP.ORTPLZ, SP.ORT, SP.LANDNR, la3.intranr, SP.Telefon, SP.Fax, SP.Telex, LF.ZUSCHL2ABS, LF.ZUSCHL1ABS, LF.ZUSCHL3ABS, LF.ZUSCHL4ABS, LF.ZUSCHL5ABS, LF.MWSTBetrag1, LF.MWST1, LP.Eintreffdatum, LP.Eintreffzeit, l.RechGutVortext, l.text2, L.liefbednr, lb.incoterm from lieferung l , land LA , land LA2 , land LA3 ,ZAHLBED ZB, VVKSTATDETAILSUM VD, LIEFFUSS LF , LSSPEDDATEN LP, SPEDITION SP, KUNDE KD, LIEFBED LB where L.KDNR= KD.KDNR AND L.landnr = la.landnr AND L.lieflandnr = la2.landnr AND L.zahlbednr = ZB.Zahlbednr AND l.liefnr = VD.liefnr AND LB.Liefbednr = l.liefbednr AND l.liefnr = LF.LIEFNR AND l.sendungsnr = LP.sendungsnr AND LP.speditionnr=SP.speditionnr AND SP.Landnr = la3.landnr (+) AND l.sendungsnr >0 and l.rechnr >0 and l.sendungsnr in (SELECT SENDUNGSNR FROM zollschnitt where erledigt = 0) ;
CREATE VIEW VZOLLPOS (PVERSION, PSENDNR, PLIEFNR, PRECHNR, PLIEFPOSNR, PARTNR, PARTTEXT, PARTKD, PURLAND, PMENGE, PMENGEEINH, PPREISEINH, PNETTOGEWEINZ, PNETTOGEWPOS, PNETTOEINZHW, PNETTOPOSHW,PNETTOEINZFW, PNETTOPOSFW, PARTEXT, PARTGRUP, PWARENCODE) AS SELECT '1.50', ZK.HSENDNR, ZK.HLIEFNR, ZK.HRECHNR, LP.LIEFPOSNR, LP.ARTNR, LP.ARTTEXT, LP.KDARTNR, AR.URSPRUNGSLAND, LP.MENGE, LP.MENGEEINH, 1, @DECODE(GewEinheit,'gr',AR.GEWICHTBRUTTO/1000,Ar.GEWICHTBRUTTO), VG.LGNettoGew, VK.NETTOEINZEL, VK.GESAMTNETTO, LP.VK, LP.NETTOGESAMT, AR.TEXT, AR.ARTGRU, AR.WARENCODE FROM VZOLLKOPF ZK, LIEFPOS LP, ARTIKEL AR, VKSTATDETAIL VK, VLSKARTONGW VG WHERE ZK.HLIEFNR=LP.LIEFNR AND LP.ARTNR = AR.ARTNR AND VK.LIEFNR= LP.LIEFNR AND VK.LIEFPOSNR = LP.LIEFPOSNR AND LP.ARTNR=VK.ARTNR AND VK.Liefnr = VG.LGLiefnr AND VK.LIefposNr = VG.LGLiefposNr;
CREATE VIEW VZOLLVERP (VVERSION, VSENDNR, VLIEFNR, VRECHNR, VLIEFPOSNR,VVERPACK, VANZAHL, VDIM1, VDIM2, VDIM3, VDIMEINHEIT, VNETTOGEWEINZ, VVERPACKTEXT, VTEILEART) AS SELECT '1.50', ZP.PSENDNR, ZP.PLIEFNR, ZP.PRECHNR, ZP.PLIEFPOSNR, AR.ARTNR, PA.ANZBHV, AR.DIM1, AR.DIM2, AR.DIM3, AR.DIMEINHEIT, AR.GEWICHTNETTO, AR.Verpackungstext, AR.Teileart FROM VZOLLPOS ZP, VLSKARTON PA, ARTIKEL AR WHERE ZP.PLIEFNR=PA.LIEFNR AND ZP.PLIEFPOSNR = PA.LIEFPOSNR AND AR.ARTNR = PA.VERPACKNR AND AR.LADEEINHEIT='1';
create view VZOLLSCHNITT (HVERSION, HSENDNR, HERLEDIGT) AS SELECT '1.50', SENDUNGSNR, ERLEDIGT FROM ZOLLSCHNITT;
CREATE VIEW AFOZEITENBA (BETAUFNR, BETAUFPOSNR, AFONR, SOLLMENGE, ISTMENGE, AUSSCHUSS,ISTSTUNDEN, SOLLSTUNDEN, PLANSTARTDAT, PLANSTARTKW, PLANENDEDAT, PLANENDEKW,ISTSTARTKW, ISTENDEKW, STATUS, ANFAHRMENGE, ISTENDEDAT, ISTSTARTDAT)AS SELECT A.BETAUFNR, A.BETAUFPOSNR, A.AFONR, A.SOLLMENGE, A.ISTMENGE , A.AUSSCHUSS , A.ISTSTUNDEN , A.SOLLSTUNDEN, A.PLANSTARTDAT, A.PLANSTARTKW, A.PLANENDEDAT, A.PLANENDEKW, A.ISTSTARTKW, A.ISTENDEKW, A.STATUS, A.ANFAHRMENGE, A.ISTENDEDAT, A.ISTSTARTDAT FROM AFOZEITENBAORG A ;
CREATE VIEW V_EINRECHNUNGEN (LFDRECHNR,einrechposnr,LIEFERANTNR,BELEGDAT,WAEHRUNG,LIEFERANTBELEG,MATCHCODE, BRUTTOBETRAG,BESTNR,NETTOBETRAG,KONTO,KOSTENSTELLE ) AS Select k.LFDRECHNR,p.einrechposnr,k.LIEFERANTNR,k.BELEGDAT,k.WAEHRUNG,k.LIEFERANTBELEG,L.MATCHCODE, k.BRUTTOBETRAG,k.BESTNR,k.NETTOBETRAG,p.KONTO,p.KOSTENSTELLE FROM EINRECHKO k, EINRECHPO p,Lieferant L where k.lfdrechnr = p.lfdrechnr and k.lieferantnr = l.lieferantnr;
CREATE VIEW BetaufPos_V (BetAufNr,BetAufPosNr,AFoNr,BaStatus,ArbPlatz,ArtNr,ArtMC,ArtText,ArtGewicht,GewEinheit,IstStartDat,PlanStartDat,SollMenge,IstMenge,AFoStatus,AusserHausKz,StellPlatzNr) AS SELECT B.BetAufNr, B.BetAufPosNr, P.AFoNr, B.Status, P.ArbPlNr, B.ArtNr, A.MatchCode, A.Text, A.GewichtBrutto, A.GewEinheit, Z.IstStartDat, Z.PlanStartDat, Z.SollMenge, Z.IstMenge, Z.Status, P.AUSSERHAUSKZ, M.StellPlatzNr FROM BetrAuftr B, Artikel A, ArbPlaPoBA P, AFoZeitenBA Z, ArbPlatz M WHERE B.BetAufNr = P.BetAufNr AND B.BetAufPosNr = P.BetAufPosNr AND P.BetAufNr = Z.BetAufNr AND P.BetAufPosNr = Z.BetAufPosNr AND P.AFoNR = Z.AFoNr AND P.ArbPlNr = M.ArbPlNr AND B.Status != 'erledigt' AND B.ArtNr = A.ArtNr AND P.Engpass = '1';
CREATE VIEW BetaufPosLA_V (BetAufNr,BetAufPosNr,AFoNrL,ArtNr,MengeProVerp,VerpackArtNr) AS SELECT B.BetAufNr, B.BetAufPosNr, P.AFoNr, B.ArtNr, V.AnzVerpack, V.VerpackNr FROM BetrAuftr B, ArbPlaPoBA P, Verpackungen V WHERE B.BetAufNr = P.BetAufNr AND B.BetAufPosNr = P.BetAufPosNr AND B.Status != 'erledigt' AND B.VpStuLiNr = V.LfdNr AND V.Position = 0 AND P.AFoNr = ( SELECT MAX(AFoNr) FROM ArbPlaPoBA P WHERE B.BetAufNr = P.BetAufNr AND B.BetAufPosNr = P.BetAufPosNr );
CREATE VIEW V_Kore (artnr, matchcode, identnr, artgru, projektnr, charakterschl, kdnr) AS SELECT artnr, matchcode, identnr, artgru, projektnr, charakterschl, kdnr FROM artikel;
CREATE VIEW VMESTAFARTLIEF ( LieferantNr, ArtNr, StaffelKz, Datum, Datum1, Datum2, Datum3, Datum4, Datum5, AbMenge, Wert, Wert1, Wert2, Wert3, Wert4, Wert5 ) AS SELECT K.LieferantNr, K.ArtNr, K.StaffelKz, K.Datum, K.Datum1, K.Datum2, K.Datum3, K.Datum4, K.Datum5, P.AbMenge, P.Wert, P.Wert1, P.Wert2, P.Wert3, P.Wert4, P.Wert5 FROM MeStafArtLiefKo K, MeStafArtLiefPo P WHERE P.LieferantNr = K.LieferantNr AND P.ArtNr = K.ArtNr;
CREATE VIEW ARBPLAPOWKZBA ( AFOERLEDIGTKZ, AFONR, ANZLOHNSCHEINE, APLNR, ARBGANGKUERZEL, ARBPLGRUPNR, ARBPLNR, AUSSERHAUSKZ,BETAUFNR, BETAUFPOSNR, BEZEICHNUNG, ERSTEKW, FERTART, KAPAZITAETSKZ, KSTGRUNR, KSTNR,KW1, KW10, KW11, KW12, KW13, KW14, KW15, KW16, KW17, KW18, KW19,KW2, KW20, KW21, KW22, KW23, KW24, KW25, KW26, KW27, KW28, KW29,KW3, KW30, KW31, KW32, KW33, KW34, KW35, KW36, KW37, KW38, KW39,KW4, KW40, KW41, KW42, KW43, KW44, KW45, KW46, KW47, KW48, KW49,KW5, KW50, KW51, KW52, KW53, KW54, KW55, KW56, KW57, KW58, KW59,KW6, KW60, KW61, KW62, KW63, KW64, KW65, KW66, KW67, KW68, KW69,KW7, KW70, KW71, KW72, KW73, KW74, KW75, KW76, KW77, KW78, KW79,KW8, KW80, KW81, KW82, KW83, KW84, KW85, KW86, KW87, KW88, KW89,KW9, KW90, KW91, KW92, KW93, KW94, KW95, KW96, KW97, KW98, KW99, KW100,LETZTEKW, LOHNFGK, LOHNGRUPPE, LOHNGRUPPERUEST, LOHNSCHKZ, LOHNSTDSATZ, MASCHFGK, MASCHSTDSATZ,MEILENSTEINAFO, POSNR, PRUEFSCHRITT, PRUEFSCHRITTNR, STATISTIKKZ, SUMME, UEBERLAPPMENGE, UEBERLAPPZEIT,ZUSATZKZ, STDSATZ, MEILENSTEINDATUM) AS SELECT AFOERLEDIGTKZ, AFONR, ANZLOHNSCHEINE, APLNR, ARBGANGKUERZEL, ARBPLGRUPNR, ARBPLNR, AUSSERHAUSKZ, BETAUFNR, BETAUFPOSNR, BEZEICHNUNG, ERSTEKW, FERTART, KAPAZITAETSKZ, KSTGRUNR, KSTNR, KW1, KW10, KW11, KW12, KW13, KW14, KW15, KW16, KW17, KW18, KW19, KW2, KW20, KW21, KW22, KW23, KW24, KW25, KW26, KW27, KW28, KW29, KW3, KW30, KW31, KW32, KW33, KW34, KW35, KW36, KW37, KW38, KW39, KW4, KW40, KW41, KW42, KW43, KW44, KW45, KW46, KW47, KW48, KW49, KW5, KW50, KW51, KW52, KW53, KW54, KW55, KW56, KW57, KW58, KW59, KW6, KW60, KW61, KW62, KW63, KW64, KW65, KW66, KW67, KW68, KW69, KW7, KW70, KW71, KW72, KW73, KW74, KW75, KW76, KW77, KW78, KW79, KW8, KW80, KW81, KW82, KW83, KW84, KW85, KW86, KW87, KW88, KW89, KW9, KW90, KW91, KW92, KW93, KW94, KW95, KW96, KW97, KW98, KW99, KW100, LETZTEKW, LOHNFGK, LOHNGRUPPE, LOHNGRUPPERUEST, LOHNSCHKZ, LOHNSTDSATZ, MASCHFGK, MASCHSTDSATZ, MEILENSTEINAFO, POSNR, PRUEFSCHRITT, PRUEFSCHRITTNR, STATISTIKKZ, SUMME, UEBERLAPPMENGE, UEBERLAPPZEIT, ZUSATZKZ, STDSATZ, MEILENSTEINDATUM FROM ARBPLAPOWKZBAORG WHERE BASISPLAN = 0 ;
CREATE VIEW SKKD (ARTNR, BEWEGART, BELEGNR, BELEGPOSNR, SPENDE, BKZ, LFDNR, ZUAB, SPSTART, MENGE, QUELLBELEGPOSNR, QUELLBELEGNR, KDLIEFERANTNR, KDLIEFERANTKZ, QUELLBELEGART, FREIGABETAGE, BAAUFKZ, TERMINKZKZ, OPKZ, BELEGART, AFONR, STEUERCODE, STULIPOSNR, TERMSTAFFNR, MISCHURSPRUNG, MISCHMENGE, BEDARFDATUM, GBART, ERZLFDNR, AUFLOESKZ, LOESCHKZ, KN_PLAN, ZEITSTMP, WERKNREIGEN, WERKFREMD) AS SELECT S.ARTNR, S.BEWEGART, S.BELEGNR, S.BELEGPOSNR, S.SPENDE, S.BKZ, S.LFDNR, S.ZUAB, S.SPSTART, S.MENGE, S.QUELLBELEGPOSNR, S.QUELLBELEGNR, S.KDLIEFERANTNR, S.KDLIEFERANTKZ, S.QUELLBELEGART, S.FREIGABETAGE, S.BAAUFKZ, S.TERMINKZKZ, S.OPKZ, S.BELEGART, S.AFONR, S.STEUERCODE, S.STULIPOSNR, S.TERMSTAFFNR, S.MISCHURSPRUNG, S.MISCHMENGE, S.BEDARFDATUM, S.GBART, S.ERZLFDNR, S.AUFLOESKZ, S.LOESCHKZ, S.KN_PLAN, S.ZEITSTMP, S.WERKNREIGEN, S.WERKFREMD FROM SaKo S, Artikel A WHERE S.BewegArt IN ('RA','OF','SA') AND S.KdLieferantNr IS NOT NULL AND A.ArtNr = S.ArtNr AND A.BedAuf = 'K';
CREATE VIEW SKVP (ARTNR, BEWEGART, BELEGNR, BELEGPOSNR, SPENDE, BKZ, LFDNR, ZUAB, SPSTART, MENGE, QUELLBELEGPOSNR, QUELLBELEGNR, KDLIEFERANTNR, KDLIEFERANTKZ, QUELLBELEGART, FREIGABETAGE, BAAUFKZ, TERMINKZKZ, OPKZ, BELEGART, AFONR, STEUERCODE, STULIPOSNR, TERMSTAFFNR, MISCHURSPRUNG, MISCHMENGE,BEDARFDATUM, GBART, ERZLFDNR, AUFLOESKZ, LOESCHKZ, KN_PLAN, ZEITSTMP,WERKNREIGEN, VPStuliNr, WerkFremd)AS SELECT S.ARTNR, S.BEWEGART, S.BELEGNR, S.BELEGPOSNR, S.SPENDE, S.BKZ, S.LFDNR, S.ZUAB, S.SPSTART, S.MENGE, S.QUELLBELEGPOSNR, S.QUELLBELEGNR, S.KDLIEFERANTNR, S.KDLIEFERANTKZ, S.QUELLBELEGART, S.FREIGABETAGE, S.BAAUFKZ, S.TERMINKZKZ, S.OPKZ, S.BELEGART, S.AFONR, S.STEUERCODE, S.STULIPOSNR, S.TERMSTAFFNR, S.MISCHURSPRUNG, S.MISCHMENGE, S.BEDARFDATUM, S.GBART, S.ERZLFDNR, S.AUFLOESKZ, S.LOESCHKZ, S.KN_PLAN, S.ZEITSTMP, S.WERKNREIGEN, K.SetNr, S.WERKFREMD FROM SaKo S, Artikel A, AuftrPos K WHERE S.BewegArt = 'RA' AND A.ArtNr = S.ArtNr AND A.BedAuf = 'V' AND K.AuftrNr = S.BelegNr AND K.AuftrPosNr = S.BelegPosNr AND K.SetNr IS NOT NULL UNION SELECT S.ARTNR, S.BEWEGART, S.BELEGNR, S.BELEGPOSNR, S.SPENDE, S.BKZ, S.LFDNR, S.ZUAB, S.SPSTART, S.MENGE, S.QUELLBELEGPOSNR, S.QUELLBELEGNR, S.KDLIEFERANTNR, S.KDLIEFERANTKZ, S.QUELLBELEGART, S.FREIGABETAGE, S.BAAUFKZ, S.TERMINKZKZ, S.OPKZ, S.BELEGART, S.AFONR, S.STEUERCODE, S.STULIPOSNR, S.TERMSTAFFNR, S.MISCHURSPRUNG, S.MISCHMENGE, S.BEDARFDATUM, S.GBART, S.ERZLFDNR, S.AUFLOESKZ, S.LOESCHKZ, S.KN_PLAN, S.ZEITSTMP, S.WERKNREIGEN, B.VPStuliNr, S.WERKFREMD FROM SaKo S, Artikel A, BetrAuftr B WHERE S.BewegArt IN ('OF','SA') AND A.ArtNr = S.ArtNr AND A.BedAuf = 'V' AND B.BetAufNr = S.BelegNr AND B.BetAufPosNr = S.BelegPosNr AND B.VPStuliNr IS NOT NULL;
create view VBESTTERMSTAFF( BestNr, BestPosNr, ArtNr, ArtMatchcode, Menge, LiefDatum, ArtText, BestSuch, LieferantNr, Matchcode, TeilLieferlaubt, UntLiefProz, UebLiefProz, ArtNrLief, Status, UeberLiefErlaubt, BestellArt, NrKreisNr, BestDatum, InfoID, Verfallszeit, StandardPreis, BeistellungsKz, KonsiKz, BEAbbuchKz, WunschGeprueft, NrKreisNrLiefAdr, Herkunft ) AS SELECT A0.BestNr, A1.BestPosNr, A1.ArtNr, A3.Matchcode, @DECODE(T.Teilmenge,NULL,A1.Menge,0,A1.Menge,T.Teilmenge), T.BestellDatum, A1.ArtText, A0.BestSuch, A0.LieferantNr, A2.Matchcode, A1.TeilLiefErlaubt, A1.UntLiefProz, A1.UebLiefProz, A1.ArtNrLief, A1.Status, A2.UeberLiefErlaubt, A0.BestellArt, A0.NrKreisNr, A0.BestDatum, A1.InfoID, A3.Verfallszeit, A3.StandardPreis, A3.BeistellungsKz, A1.KonsiKz, A1.BEAbbuchKz, A0.WunschGeprueft, A0.NrKreisNrLiefAdr, 1 FROM BESTKO A0, BESTPOS A1, LIEFERANT A2, ARTIKEL A3, TermStaffBestPos T WHERE A0.BestNr = A1.BestNr AND A1.ArtNr = A3.ArtNr AND A0.LieferantNr = A2.LieferantNr AND A0.Bestellart != 'I' AND A1.BestNr = T.BestNr AND A1.BestPosNr = T.BestPosNr AND T.Typ = 'B' AND T.BestellDatum IN (SELECT MIN(T2.BestellDatum) FROM TermStaffBestPos T2 WHERE T2.Typ = 'B' AND T2.BestNr = T.BestNr AND T2.BestPosNr = T.BestPosNr) UNION ALL SELECT A5.BestNr, A6.BestPosNr, A6.ArtNr, A8.Matchcode, @DECODE(A6.Abrufsumme,NULL,A6.Menge,0,A6.Menge,A6.Abrufsumme), @NULLVALUE(A6.LiefDatBestaetigt,A6.LiefDatum), A6.ArtText, A5.BestSuch, A5.LieferantNr, A7.Matchcode, A6.TeilLiefErlaubt, A6.UntLiefProz, A6.UebLiefProz, A6.ArtNrLief, A6.Status, A7.UeberLiefErlaubt, A5.BestellArt, A5.NrKreisNr, A5.BestDatum, A6.InfoID, A8.Verfallszeit, A8.StandardPreis, A8.BeistellungsKz, A6.KonsiKz, A6.BEAbbuchKz, A5.WunschGeprueft, A5.NrKreisNrLiefAdr, 2 FROM BESTKO A5, BESTPOS A6, LIEFERANT A7, ARTIKEL A8 WHERE A5.BestNr = A6.BestNr AND A6.ArtNr = A8.ArtNr AND A5.LieferantNr = A7.LieferantNr AND A5.Bestellart != 'I' AND NOT EXISTS (SELECT 2 FROM TermStaffBestPos T3 WHERE T3.Typ = 'B' AND A6.BestNr = T3.BestNr AND A6.BestPosNr = T3.BestPosNr);
CREATE VIEW VNCPROGRAMM (LfdNr, ViewRowID, ArtNr, ProgNr, ProgIdx) AS SELECT LfdNr, RowID, ArtNr, ProgNr, ProgIdx FROM NCPROGRAMM UNION ALL SELECT 0, NULL, 'DEFAULT', '', '' FROM QUER WHERE LFDNR = 2;
CREATE VIEW VLAGERSUM (LAGERPLATZ, ARTNR) AS SELECT MIN(L.LagerPlatz), L.ArtNr FROM Lager L, LagerPlatz LP WHERE LP.LagerPlatz = L.LagerPlatz AND LP.SperrKz != '1' AND (LP.LagerPlatz NOT LIKE '~%' or LP.LagerPlatz IS NULL) AND LP.LiefLager != '1' GROUP BY L.ArtNr;
CREATE VIEW VQSSPERRBE( LfdNr, BelegNr, BelegPosNr, ArtNrLief, LagerArtKz, ArtText, PreisEinh, EK, Rab1, Rab2, RabRegel, LiefDatum, MengeEinh, BestSuch, LieferantNr, BestellArt, Ursprung ) AS SELECT S1.LfdNr, S1.BelegNr, S1.BelegPosNr, @NULLVALUE(S1.ArtNrLief,P.ArtNrLief), S1.LagerArtKz, P.ArtText, P.PreisEinh, P.EK, P.Rab1, P.Rab2, P.RabRegel, @DATETOCHAR(P.LiefDatum,'YYYY-MM-DD'), P.MengeEinh, K.BestSuch, @NULLVALUE(S1.LieferantNr,K.LieferantNr), K.BestellArt, 1 FROM Sperrlager S1, BestPos P, BestKo K WHERE S1.BelegPosNr = P.BestPosNr AND S1.BelegNr = P.BestNr AND S1.BelegNr = K.BestNr AND S1.LagerArtKz IN ('Q','S','W') AND S1.Herkunft = 'B' AND S1.BelegNrLieferant IS NOT NULL UNION ALL SELECT S2.LfdNr, S2.BelegNr, S2.BelegPosNr, @NULLVALUE(S2.ArtNrLief,AL.ArtLieferantenNr), S2.LagerArtKz, AL.ArtLiefText, AL.PreisEinh, AL.EK, 0, 0, NULL, NULL, AL.MengenEinh, NULL, S2.LieferantNr, NULL, 2 FROM Sperrlager S2, ArtLief AL WHERE S2.ArtNr = AL.ArtNr(+) AND S2.LieferantNr = AL.LieferantNr(+) AND S2.BelegNr IS NULL AND S2.BelegPosNr IS NULL AND S2.LagerArtKz IN ('Q','S','W') AND S2.Herkunft = 'B' AND S2.BelegNrLieferant IS NOT NULL ;
create view vFreierLagerplatz (bruttogew_lager, lagerplatz, bruttogew_karton, MaximaleBelegung, kartonnr, artnr) as select sum(l.bruttogew), l.lagerplatz, l2.bruttogew, p.MaximaleBelegung, l2.kartonnr, l2.artnr from lager l, lagerplatz p, lager l2 where l2.artnr= l.artnr and p. MENGEEINH = 'kg' and l.lagerplatz= p.lagerplatz and exists ( select 2 from versandverwaltung v, LAGERPLATZ pu where @NULLVALUE(v.Stapelhoehe,0) <= @NULLVALUE (pu.hoehe,0) and v.artnr = l2.artnr and pu.lagerplatz = p.lagerplatz ) group by l.lagerplatz, l2.bruttogew,p.MaximaleBelegung, l2.kartonnr, l2.artnr having sum(l.bruttogew) + l2.bruttogew <= p.MaximaleBelegung ;
create view vTelefon (Partner, Name, Ort, Name1Kunde, Name2Kunde, Name3Kunde, OrtKunde, Telefon, Fax, Email, HERKUNFT) as select kdnr as Partner, '' as Name, '' as Ort, Name1, name2, name3, ort, telefon, fax, telex, 'KD' as Herkunft FROM KUNDE union select lieferantnr , '' , '' , name1, name2, name3, ort, telefon, fax, telex, 'LI' FROM LIEFERANT union select a.kdnr, a.name , a.Ort, b.Name1, b.Name2 , b.name3 , b.ort, a.telefon, a.fax, a.email, 'KA' from ansprpart a, kunde b where a.kdnr = b.kdnr and a.kdnr is not null union select a.liefnr , a.name , a.Ort, b.Name1 , b.Name2, b.name3 , b.ort, a.telefon, a.fax, a.email, 'LA' from ansprpart a, lieferant b where a.liefnr = b.lieferantnr and a.liefnr is not null union select kdnr , '' , '' , name1, name2, name3, ort, telefon, fax, telex, 'KL' from liefadr union select lieferantnr , '' , '' , name1, name2, name3, ort, telefon, fax, telex, 'LB' from bestadr;
