// <ppj name="Moveta.Intern" date="1/17/2024 7:59:41 AM" id="F4EC85BAD2BF79AC25C9F8643540E90F9BE1DAF0"/>
// ======================================================================================================
// This code was generated by the Ice Porter(tm) Tool version 4.8.15.0
// Ice Porter is part of The Porting Project (PPJ) by Ice Tea Group, LLC.
// The generated code is not guaranteed to be accurate and to compile without
// manual modifications.
// 
// ICE TEA GROUP LLC SHALL IN NO EVENT BE LIABLE FOR ANY DAMAGES WHATSOEVER
// (INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS OF BUSINESS PROFITS, BUSINESS
// INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY OTHER LOSS OF ANY KIND)
// ARISING OUT OF THE USE OR INABILITY TO USE THE GENERATED CODE, WHETHER
// DIRECT, INDIRECT, INCIDENTAL, CONSEQUENTIAL, SPECIAL OR OTHERWISE, REGARDLESS
// OF THE FORM OF ACTION, EVEN IF ICE TEA GROUP LLC HAS BEEN ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGES.
// =====================================================================================================
using System;
using System.Text;
using System.Drawing;
using System.Diagnostics;
using System.Collections;
using System.Windows.Forms;
using System.ComponentModel;
using MT;
using PPJ.Runtime;
using PPJ.Runtime.Com;
using PPJ.Runtime.Sql;
using PPJ.Runtime.Vis;
using PPJ.Runtime.Windows;
using PPJ.Runtime.Windows.QO;
using PPJ.Runtime.XSal;

namespace Moveta.Intern
{
	
	/// <summary>
	/// </summary>
	public class Fiskaly : SalFunctionalClass
	{
		#region Fields
		public static SalString APIKey = "";
		public static SalString APISecret = "";
		public static SalString ADMIN_PIN = "";
		public static SalString TSS_ID = "";
		public static SalString CLIENT_ID = "";
		public static SalString TX_ID = "";
		public static SalString EXPORT_ID = "";
		public static SalString SERIAL_NUMBER = "";
		public static SalString STATE = "";
		public static SalString DESCRIPTION = "";
		public static SalString PROCESS_TYPE = "";
		public static SalString PROCESS_DATA = "";
		public static SalString START_DATE = "";
		public static SalString END_DATE = "";
		public static SalString URL_DOWNLOAD = "";
		public static SalString FILE_DOWNLOAD = "";
		public static SalNumber LASTREVISION = 0;
		public static SalNumber RESPONSE_STATUS = 0;
		public static SalString RESPONSE_CONTENT = "";
		public static SalString RESPONSE_XML = "";
		public static SalString RESPONSE_ERROR = "";
		public static SalString LogPath = "";
		public static SalString ResultPath = "";
		public static SalString VERSION = "";
		public static FiskalyTSS TSS = new FiskalyTSS();
		public static FiskalyTSSList TSS_LIST = new FiskalyTSSList();
		public static FiskalyClient CLIENT = new FiskalyClient();
		public static FiskalyClientList CLIENT_LIST = new FiskalyClientList();
		public static FiskalyExport EXPORT = new FiskalyExport();
		public static FiskalyExportList EXPORT_LIST = new FiskalyExportList();
		public static FiskalyTransaction TRANSACTION = new FiskalyTransaction();
		public static FiskalyTransactionList TRANSACTION_LIST = new FiskalyTransactionList();
		public static FiskalyTSS_V2 TSS_V2 = new FiskalyTSS_V2();
		public static FiskalyTSSList_V2 TSS_LIST_V2 = new FiskalyTSSList_V2();
		public static FiskalyClient_V2 CLIENT_V2 = new FiskalyClient_V2();
		public static FiskalyClientList_V2 CLIENT_LIST_V2 = new FiskalyClientList_V2();
		public static FiskalyTransaction_V2 TRANSACTION_V2 = new FiskalyTransaction_V2();
		public static FiskalyTransactionList_V2 TRANSACTION_LIST_V2 = new FiskalyTransactionList_V2();
		public static FiskalyExport_V2 EXPORT_V2 = new FiskalyExport_V2();
		public static FiskalyExportList_V2 EXPORT_LIST_V2 = new FiskalyExportList_V2();
		#endregion
		
		#region Constructors/Destructors
		#endregion
		
		#region Methods
		// -- in version greater 6.2 with constructor
		/// <summary>
		/// </summary>
		/// <param name="p_strAPIKey"></param>
		/// <param name="p_strAPISecret"></param>
		/// <param name="p_strVersion"></param>
		/// <returns></returns>
		public SalNumber fInit(SalString p_strAPIKey, SalString p_strAPISecret, SalString p_strVersion)
		{
			// String: p_strLogPath
			// String: p_strResultPath
			
			#region Local Variables
			SalString strPfadProgramData = "";
			#endregion
			
			#region Actions
			Fiskaly.APIKey = p_strAPIKey;
			Fiskaly.APISecret = p_strAPISecret;
			// Set LogPath=p_strLogPath
			// Set ResultPath=p_strResultPath
			strPfadProgramData = Vis.DosGetEnvString("APPDATA") + "\\\\Moveta";
			Sal.FileCreateDirectory(strPfadProgramData);
			Fiskaly.LogPath = strPfadProgramData + "\\\\";
			Fiskaly.ResultPath = strPfadProgramData + "\\\\";
			Fiskaly.VERSION = p_strVersion;
			// Task: ohne DLL
			// Inserted: 2020-08-25-14.48
			// Symbol is undefined or unable to be referenced from current location: FISKALY_CLIENT
			// Call FISKALY_CLIENT.FiskalyClient( APIKey, APISecret )

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_hWndList"></param>
		/// <returns></returns>
		public SalNumber fFillMethods(SalWindowHandle p_hWndList)
		{
			#region Local Variables
			SalArray<SalString> strMethods = new SalArray<SalString>();
			#endregion
			
			#region Actions
			// Task: ohne DLL
			// Inserted: 2020-08-25-14.49
			// Symbol is undefined or unable to be referenced from current location: FISKALY_CLIENT
			// Call SalStrTokenize( FISKALY_CLIENT.GetApiMethods(  ), '|', '|', strMethods)
			// -- GeÃ¤ndert (14.10.2021)
			if (Fiskaly.VERSION == "V1") 
			{
				strMethods[0] = "ListTSS";
				strMethods[1] = "RetrieveTSS";
				strMethods[2] = "CreateOrUpdateTSS";
				strMethods[3] = "ListAllClients";
				strMethods[4] = "ListClientsOfTSS";
				strMethods[5] = "RetrieveClient";
				strMethods[6] = "CreateOrUpdateClient";
				strMethods[7] = "ListAllTransactions";
				strMethods[8] = "ListTransactionsOfTSS";
				strMethods[9] = "ListTransactionsOfClient";
				strMethods[10] = "RetrieveTransaction";
				strMethods[11] = "CreateOrUpdateTransaction";
				strMethods[12] = "ListAllExports";
				strMethods[13] = "ListExportsOfTSS";
				strMethods[14] = "RetrieveExport";
				strMethods[15] = "CancelExport";
				strMethods[16] = "TriggerExport";
				strMethods[17] = "Download";
			}
			else
			{
				strMethods[0] = "ListTSS";
				strMethods[1] = "RetrieveTSS";
				strMethods[2] = "CreateAndUpdateTSS";
				strMethods[3] = "UpdateTSS";
				strMethods[4] = "ListAllClients";
				strMethods[5] = "ListClientsOfTSS";
				strMethods[6] = "RetrieveClient";
				strMethods[7] = "CreateClient";
				strMethods[8] = "ListAllTransactions";
				strMethods[9] = "ListTransactionsOfTSS";
				strMethods[10] = "ListTransactionsOfClient";
				strMethods[11] = "RetrieveTransaction";
				strMethods[12] = "CreateTransaction";
				strMethods[13] = "FinishTransaction";
				strMethods[14] = "CancelTransaction";
				strMethods[15] = "ListAllExports";
				strMethods[16] = "ListExportsOfTSS";
				strMethods[17] = "RetrieveExport";
				strMethods[18] = "CancelExport";
				strMethods[19] = "TriggerExport";
				strMethods[20] = "RetrieveFileOfExport";
			}
			Vis.ListArrayPopulate(p_hWndList, strMethods);

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_hWndList"></param>
		/// <param name="p_strParam"></param>
		/// <returns></returns>
		public SalNumber fFillStates(SalWindowHandle p_hWndList, SalString p_strParam)
		{
			#region Local Variables
			SalArray<SalString> strParams = new SalArray<SalString>();
			#endregion
			
			#region Actions
			if (p_strParam == "TSS") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-25-14.49
				// Symbol is undefined or unable to be referenced from current location: FISKALY_CLIENT
				// Call SalStrTokenize( FISKALY_CLIENT.GetTSSStates(  ), '|', '|', strParams)
				strParams[0] = "CREATED";
				strParams[1] = "UNINITIALIZED";
				strParams[2] = "INITIALIZED";
				strParams[3] = "DISABLED";
				strParams[4] = "DELETED";
				strParams[5] = "DEFECTIVE";
				Vis.ListArrayPopulate(p_hWndList, strParams);
			}

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strMethod"></param>
		/// <param name="rp_strResponse"></param>
		/// <returns></returns>
		public SalNumber fRunMethod(SalString p_strMethod, ref SalString rp_strResponse)
		{
			#region Local Variables
			SalString strCommand = "";
			SalString strParameter = "";
			SalBoolean bOk = false;
			#endregion
			
			#region Actions
			if (Fiskaly.VERSION == "V1") 
			{
				strCommand = Var.strTVNPath + "\\FISKALYCLIENTCONSOLE.EXE \"" + Fiskaly.APIKey + "\"  \"" + Fiskaly.APISecret + "\"  \"" + Fiskaly.LogPath + "\"  \"" + Fiskaly.ResultPath + "\"  \"20\" \"1\" \"" + p_strMethod + "\"";
				// Set strCommand=strDir || '\\FISKALYCLIENTCONSOLE.EXE "' ||
				// 		APIKey || '"  "' ||
				// 		APISecret || '"  "' ||
				// 		LogPath || '"  "' ||
				// 		ResultPath || '"  "' ||
				// 		SalNumberToStrX( nFiskalyTimeout, 0 ) || '"  "1"  "' ||
				// 		p_strMethod || '"'
			}
			else
			{
				strCommand = Var.strTVNPath + "\\FISKALYCLIENTCONSOLEV2.EXE \"" + Fiskaly.APIKey + "\"  \"" + Fiskaly.APISecret + "\"  \"" + Fiskaly.LogPath + "\"  \"" + Fiskaly.ResultPath + "\"  \"0\" \"1\" \"1\" \"" + p_strMethod + "\"";
			}
			Int.PalLogToFile(strCommand, 0);
			// -- Methods TSS
			if (p_strMethod == "ListTSS") 
			{
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				// Task: ohne DLL
				// Inserted: 2020-08-25-15.05
				// Symbol is undefined or unable to be referenced from current location: FISKALY_CLIENT
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListTSS( '', '', -1, 0, '' )
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-25-15.05
					// Symbol is undefined or unable to be referenced from current location: FISKALY_CLIENT
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_TSS", 0);
						rp_strResponse = "TSS_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_TSS_V2", 0);
						rp_strResponse = "TSS_LIST_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.01
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "RetrieveTSS") 
			{
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				bOk = Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				// Task: ohne DLL
				// Inserted: 2020-08-31-07.55
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.RetrieveTSS(  )
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.00
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_TSS", 1);
						rp_strResponse = "TSS";
					}
					else
					{
						ParseDataFromXML("Fiskaly_TSS_V2", 1);
						rp_strResponse = "TSS_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.02
					// Symbol is undefined or unable to be referenced from current location: FISKALY_CLIENT
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// nur V1
			else if (p_strMethod == "CreateOrUpdateTSS") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.20
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateTSS( DESCRIPTION, STATE )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "DESCRIPTION=" + Fiskaly.DESCRIPTION + "&" + "STATE=" + Fiskaly.STATE;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.22
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					ParseDataFromXML("Fiskaly_TSS", 1);
					rp_strResponse = "TSS";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.23
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = "";
					Fiskaly.RESPONSE_CONTENT = "";
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- GeÃ¤ndert (24.10.2021) - nur V2
			else if (p_strMethod == "CreateAndUpdateTSS") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.20
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateTSS( DESCRIPTION, STATE )
				if (Fiskaly.TSS_ID.Length > 0) 
				{
					strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN + "&" + "DESCRIPTION=" + Fiskaly.DESCRIPTION;
				}
				else
				{
					strParameter = "ADMIN_PIN=" + Fiskaly.ADMIN_PIN + "&" + "DESCRIPTION=" + Fiskaly.DESCRIPTION;
				}
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.22
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					ParseDataFromXML("Fiskaly_TSS_V2", 1);
					rp_strResponse = "TSS_V2";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.23
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "UpdateTSS") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.20
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateTSS( DESCRIPTION, STATE )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN + "&" + "DESCRIPTION=" + Fiskaly.DESCRIPTION + "&" + "STATE=" + Fiskaly.STATE;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.22
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					ParseDataFromXML("Fiskaly_TSS_V2", 1);
					rp_strResponse = "TSS_V2";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.23
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- Methods Clients
			else if (p_strMethod == "ListAllClients") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.24
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListAllClients( '', '', '', -1, 0 )
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.24
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Client", 0);
						rp_strResponse = "CLIENT_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Client_V2", 0);
						rp_strResponse = "CLIENT_LIST_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.25
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "ListClientsOfTSS") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.26
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListClientsOfTSS( '', '', '', -1, 0 )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.26
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into List Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Client", 0);
						rp_strResponse = "CLIENT_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Client_V2", 0);
						rp_strResponse = "CLIENT_LIST_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.27
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "RetrieveClient") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.30
				// Call FISKALY_CLIENT.set_CLIENT_ID( CLIENT_ID )
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.RetrieveClient(  )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.31
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Client", 1);
						rp_strResponse = "CLIENT";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Client_V2", 1);
						rp_strResponse = "CLIENT_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.31
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// nur V1
			else if (p_strMethod == "CreateOrUpdateClient") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.33
				// Call FISKALY_CLIENT.set_CLIENT_ID( CLIENT_ID )
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_SERIAL_NUMBER( SERIAL_NUMBER )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateClient(  )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "SERIAL_NUMBER=" + Fiskaly.SERIAL_NUMBER;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.33
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					ParseDataFromXML("Fiskaly_Client", 1);
					rp_strResponse = "CLIENT";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.33
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = "";
					Fiskaly.RESPONSE_CONTENT = "";
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- GeÃ¤ndert (24.10.2021) - nur V2
			else if (p_strMethod == "CreateClient") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.33
				// Call FISKALY_CLIENT.set_CLIENT_ID( CLIENT_ID )
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_SERIAL_NUMBER( SERIAL_NUMBER )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateClient(  )
				if (Fiskaly.CLIENT_ID.Length > 0) 
				{
					strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "SERIAL_NUMBER=" + Fiskaly.SERIAL_NUMBER + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN;
				}
				else
				{
					if (Fiskaly.SERIAL_NUMBER.Length > 0) 
					{
						strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN;
					}
					else
					{
						strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN;
					}
				}
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.33
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					ParseDataFromXML("Fiskaly_Client_V2", 1);
					rp_strResponse = "CLIENT_V2";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.33
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- Methods Transaction
			else if (p_strMethod == "ListAllTransactions") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.35
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListAllTransactions( '', '', -1, 0, '' )
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.35
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Transaction", 0);
						rp_strResponse = "TRANSACTION_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Transaction_V2", 0);
						rp_strResponse = "TRANSACTION_LIST_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.35
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "ListTransactionsOfTSS") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.36
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListTransactionsOfTSS( '', '', -1, 0, '' )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.37
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Transaction", 0);
						rp_strResponse = "TRANSACTION_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Transaction_V2", 0);
						rp_strResponse = "TRANSACTION_LIST_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.37
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "ListTransactionsOfClient") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.38
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_CLIENT_ID( CLIENT_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListTransactionsOfClient( '', '', -1, 0, '' )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.38
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Transaction", 0);
						rp_strResponse = "TRANSACTION_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Transaction_V2", 0);
						rp_strResponse = "TRANSACTION_LIST_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.39
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "RetrieveTransaction") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.40
				// Call FISKALY_CLIENT.set_CLIENT_ID( CLIENT_ID )
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_TX_ID( TX_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.RetrieveTransaction( LASTREVISION )
				// ! -- Geändert (28.10.2021)
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "TX_ID=" + Fiskaly.TX_ID + "&" + "REVISION=" + Fiskaly.LASTREVISION.ToString(0) + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.41
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Transaction", 1);
						rp_strResponse = "TRANSACTION";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Transaction_V2", 1);
						rp_strResponse = "TRANSACTION_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.41
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// nur V1
			else if (p_strMethod == "CreateOrUpdateTransaction") 
			{
				if (Fiskaly.STATE == "ACTIVE") 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.42
					// Call FISKALY_CLIENT.set_CLIENT_ID( CLIENT_ID )
					// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
					// Call FISKALY_CLIENT.set_STATE( STATE )
					strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "STATE=" + Fiskaly.STATE;
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.45
					// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
					// Call FISKALY_CLIENT.set_CLIENT_ID( CLIENT_ID )
					// Call FISKALY_CLIENT.set_TX_ID( TX_ID )
					// Call FISKALY_CLIENT.set_STATE( STATE )
					// Call FISKALY_CLIENT.set_REVISION( LASTREVISION )
					strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "TX_ID=" + Fiskaly.TX_ID + "&" + "STATE=" + Fiskaly.STATE + "&" + "REVISION=" + Fiskaly.LASTREVISION.ToString(0);
					strParameter = strParameter + "&" + "PROCESS_TYPE=" + Fiskaly.PROCESS_TYPE + "&" + "PROCESS_DATA=" + Fiskaly.PROCESS_DATA;
				}
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.45
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateTransaction( STATE, FALSE, PROCESS_TYPE, PROCESS_DATA )
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.41
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					ParseDataFromXML("Fiskaly_Transaction", 1);
					rp_strResponse = "TRANSACTION";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.42
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = "";
					Fiskaly.RESPONSE_CONTENT = "";
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- GeÃ¤ndert (24.10.2021) - nur V2
			else if (p_strMethod == "CreateTransaction") 
			{
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN;
				if (Fiskaly.TX_ID.Length > 0) 
				{
					strParameter = strParameter + "&" + "TX_ID=" + Fiskaly.TX_ID;
				}
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.45
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateTransaction( STATE, FALSE, PROCESS_TYPE, PROCESS_DATA )
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.41
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					ParseDataFromXML("Fiskaly_Transaction_V2", 1);
					rp_strResponse = "TRANSACTION_V2";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.42
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- GeÃ¤ndert (24.10.2021) - nur V2
			else if (p_strMethod == "CancelTransaction") 
			{
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "TX_ID=" + Fiskaly.TX_ID + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN;
				if (Fiskaly.PROCESS_TYPE.Length > 0) 
				{
					strParameter = strParameter + "&" + "PROCESS_TYPE=" + Fiskaly.PROCESS_TYPE;
				}
				if (Fiskaly.PROCESS_DATA.Length > 0) 
				{
					strParameter = strParameter + "&" + "PROCESS_DATA=" + Fiskaly.PROCESS_DATA;
				}
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.45
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateTransaction( STATE, FALSE, PROCESS_TYPE, PROCESS_DATA )
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.41
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					ParseDataFromXML("Fiskaly_Transaction_V2", 1);
					rp_strResponse = "TRANSACTION_V2";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.42
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- GeÃ¤ndert (24.10.2021) - nur V2
			else if (p_strMethod == "FinishTransaction") 
			{
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "CLIENT_ID=" + Fiskaly.CLIENT_ID + "&" + "TX_ID=" + Fiskaly.TX_ID + "&" + "ADMIN_PIN=" + Fiskaly.ADMIN_PIN;
				strParameter = strParameter + "&" + "PROCESS_TYPE=" + Fiskaly.PROCESS_TYPE + "&" + "PROCESS_DATA=" + Fiskaly.PROCESS_DATA;
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.45
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CreateOrUpdateTransaction( STATE, FALSE, PROCESS_TYPE, PROCESS_DATA )
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.41
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object List
					ParseDataFromXML("Fiskaly_Transaction_V2", 1);
					rp_strResponse = "TRANSACTION_V2";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.42
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- Methods Export
			else if (p_strMethod == "ListAllExports") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.50
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListAllExports( '', '', -1, 0, '' )
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.50
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Export", 0);
						rp_strResponse = "EXPORT_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Export_V2", 0);
						rp_strResponse = "EXPORT_LIST_V2";
					}
				}
				else
				{
					// Task: ohne ELL
					// Inserted: 2020-08-31-08.51
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = "";
					Fiskaly.RESPONSE_CONTENT = "";
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "ListExportsOfTSS") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.51
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.ListExportsOfTSS('', '', -1, 0, '' )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.58
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Export", 0);
						rp_strResponse = "EXPORT_LIST";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Export_V2", 0);
						rp_strResponse = "EXPORT_LIST_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.59
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "RetrieveExport") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.52
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_EXPORT_ID( EXPORT_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.RetrieveExport(  )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "EXPORT_ID=" + Fiskaly.EXPORT_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.58
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Export", 1);
						rp_strResponse = "EXPORT";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Export_V2", 1);
						rp_strResponse = "EXPORT_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.59
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "CancelExport") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.53
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_EXPORT_ID( EXPORT_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.CancelExport(  )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "EXPORT_ID=" + Fiskaly.EXPORT_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.57
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Export", 1);
						rp_strResponse = "EXPORT";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Export_V2", 1);
						rp_strResponse = "EXPORT_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.59
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			else if (p_strMethod == "TriggerExport") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.55
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_EXPORT_ID( EXPORT_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.TriggerExport(  )
				// -- GeÃ¤ndert (13.07.2021)
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID;
				if (Fiskaly.EXPORT_ID.Length > 0) 
				{
					strParameter = strParameter + "&" + "EXPORT_ID=" + Fiskaly.EXPORT_ID;
				}
				if (Fiskaly.START_DATE.Length > 0) 
				{
					strParameter = strParameter + "&" + "START_DATE=" + Fiskaly.START_DATE;
				}
				if (Fiskaly.END_DATE.Length > 0) 
				{
					strParameter = strParameter + "&" + "END_DATE=" + Fiskaly.END_DATE;
				}
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.57
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					// - Parse XML Into Object
					if (Fiskaly.VERSION == "V1") 
					{
						ParseDataFromXML("Fiskaly_Export", 1);
						rp_strResponse = "EXPORT";
					}
					else
					{
						ParseDataFromXML("Fiskaly_Export_V2", 1);
						rp_strResponse = "EXPORT_V2";
					}
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-09.00
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- GeÃ¤ndert (13.07.2021) - nur V1
			else if (p_strMethod == "Download") 
			{
				strParameter = "URL_DOWNLOAD=" + Fiskaly.URL_DOWNLOAD + "&" + "FILE_DOWNLOAD=" + Fiskaly.FILE_DOWNLOAD;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 100) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.57
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					rp_strResponse = "Ok";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-09.00
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = "";
					Fiskaly.RESPONSE_CONTENT = "";
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			// -- GeÃ¤ndert (24.10.2021) - nur V2
			else if (p_strMethod == "RetrieveFileOfExport") 
			{
				// Task: ohne DLL
				// Inserted: 2020-08-31-08.52
				// Call FISKALY_CLIENT.set_TSS_ID( TSS_ID )
				// Call FISKALY_CLIENT.set_EXPORT_ID( EXPORT_ID )
				// Set RESPONSE_STATUS=FISKALY_CLIENT.RetrieveExport(  )
				strParameter = "TSS_ID=" + Fiskaly.TSS_ID + "&" + "EXPORT_ID=" + Fiskaly.EXPORT_ID;
				strCommand = strCommand + " \"" + strParameter + "\"";
				Sal.LoadAppAndWait(strCommand, Sys.Window_NotVisible, ref Fiskaly.RESPONSE_STATUS);
				if (Fiskaly.RESPONSE_STATUS == 200) 
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.58
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					Fiskaly.RESPONSE_XML = "";
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					rp_strResponse = "EXPORT_V2";
				}
				else
				{
					// Task: ohne DLL
					// Inserted: 2020-08-31-08.59
					// Set RESPONSE_CONTENT=FISKALY_CLIENT.get_RESPONSE_CONTENT(  )
					// Set RESPONSE_XML=FISKALY_CLIENT.get_RESPONSE_XML(  )
					// Set RESPONSE_ERROR=FISKALY_CLIENT.get_RESPONSE_ERROR(  )
					Fiskaly.RESPONSE_XML = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".XML");
					Fiskaly.RESPONSE_CONTENT = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".JSON");
					Fiskaly.RESPONSE_ERROR = fGetResultFromFile(Fiskaly.ResultPath + p_strMethod + ".ERROR");
					rp_strResponse = "";
				}
			}
			return Fiskaly.RESPONSE_STATUS;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <returns></returns>
		public SalString fNewGuid()
		{
			#region Actions
			// Task: ohne DLL
			// Inserted: 2020-08-25-15.08
			// Symbol is undefined or unable to be referenced from current location: FISKALY_CLIENT
			// Return FISKALY_CLIENT.CreateGuid()

			return "";
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strResponseFile"></param>
		/// <returns></returns>
		public SalString fGetResultFromFile(SalString p_strResponseFile)
		{
			#region Local Variables
			SalFileHandle hResponseFile = SalFileHandle.Null;
			SalString strBuffer = "";
			SalString ret_strResult = "";
			#endregion
			
			#region Actions
			ret_strResult = SalString.Null;
			strBuffer = SalString.Null;
			if (hResponseFile.Open(p_strResponseFile, Sys.OF_Read)) 
			{
				hResponseFile.Seek(0, Sys.FILE_SeekBegin);
				while (hResponseFile.Read(ref strBuffer, 100) > 0) 
				{
					ret_strResult = ret_strResult + strBuffer;
				}
				hResponseFile.Close();
			}
			return ret_strResult;
			#endregion
		}
		// Function: ParseResponse
		// Description:
		// Returns
		// String:
		// Parameters
		// Static Variables
		// Local variables
		// String: strData[*]
		// String: strDaten[*]
		// String: strField[*]
		// Number: nMax
		// Number: nMax1
		// Number: nCount
		// Number: nCount1
		// Long String: lstrJSON
		// Long String: lstrJSONTemp
		// Return
		// String: ret_strObject
		// Actions
		// Set ret_strObject=""
		// If ResponseStatus='OK'
		// Set lstrJSON=ResponseContent
		// If SalStrScan(lstrJSON,'{"data":')=0
		// Set lstrJSON=SalStrMidX(lstrJSON,9,SalStrLength(lstrJSON)-9)
		// Set nMax=SalStrScan(lstrJSON,"]")
		// If nMax!=-1
		// Set nCount=0
		// Loop
		// If SalStrMidX(lstrJSON,nCount,1)="]"
		// Break
		// Set lstrJSONTemp=lstrJSONTemp || SalStrMidX(lstrJSON,nCount,1)
		// Set nCount=nCount+1
		// Set TSSList=new FiskalyTSSList
		// Set lstrJSON=SalStrMidX(lstrJSON,0,nMax)
		// Set nCount=0
		// Loop
		// Set nMax=SalStrScan(lstrJSON,"},{")
		// If nMax=-1
		// Break
		// Set strDaten[nCount]=SalStrMidX(lstrJSON,1,nMax-1)
		// Set lstrJSON=SalStrReplaceX( lstrJSON, 0, SalStrLength(strDaten[nCount])+2, '' )
		// Set strDaten[nCount]=SalStrMidX(strDaten[nCount],1,SalStrLength(strDaten[nCount]))
		// Call SalStrTokenize(strDaten[nCount], ',', ',', strData)
		// If SalArrayGetUpperBound( strData, 1, nMax1 )
		// If nMax1>=0
		// Set TSS=new FiskalyTSS
		// Set nCount1=0
		// Loop
		// Call SalStrTokenize( strData[nCount1], ':', ':', strField)
		// Set strField[0]=SalStrMidX(strField[0],1,SalStrLength(strField[0])-2)
		// Set strField[1]=SalStrMidX(strField[1],1,SalStrLength(strField[1])-2)
		// If strField[0]='description'
		// Set TSS.description=strField[1]
		// If strField[0]='state'
		// Set TSS.state=strField[1]
		// If strField[0]='time_creation'
		// Set TSS.time_creation=SalStrToNumber(strField[1])
		// If strField[0]='time_init'
		// Set TSS.time_creation=SalStrToNumber(strField[1])
		// If strField[0]='certificate'
		// Set TSS.certificate=strField[1]
		// If strField[0]='certificate_serial'
		// Set TSS.certificate_serial=strField[1]
		// If strField[0]='public_key'
		// Set TSS.public_key=strField[1]
		// Set nCount1=nCount1+1
		// If nCount1>=nMax1
		// Break
		// Set TSSList.TSS_LIST[nCount]=TSS
		// Set nCount=nCount+1
		// Set ret_strObject="TSSList"
		// Else If SalStrScan(lstrJSON,'{')=0
		// Set lstrJSON=SalStrMidX(lstrJSON,1,SalStrLength(lstrJSON)-2)
		// Call SalStrTokenize(lstrJSON, ',', ',', strData)
		// If SalArrayGetUpperBound( strData, 1, nMax )
		// If nMax>=0
		// Set TSS=new FiskalyTSS
		// Set nCount=0
		// Loop
		// Call SalStrTokenize( strData[nCount], ':', ':', strField)
		// Set strField[0]=SalStrMidX(strField[0],1,SalStrLength(strField[0])-2)
		// Set strField[1]=SalStrMidX(strField[1],1,SalStrLength(strField[1])-2)
		// If strField[0]='description'
		// Set TSS.description=strField[1]
		// If strField[0]='state'
		// Set TSS.state=strField[1]
		// If strField[0]='time_creation'
		// Set TSS.time_creation=SalStrToNumber(strField[1])
		// If strField[0]='time_init'
		// Set TSS.time_creation=SalStrToNumber(strField[1])
		// If strField[0]='certificate'
		// Set TSS.certificate=strField[1]
		// If strField[0]='certificate_serial'
		// Set TSS.certificate_serial=strField[1]
		// If strField[0]='public_key'
		// Set TSS.public_key=strField[1]
		// Set nCount=nCount+1
		// If nCount>=nMax
		// Break
		// Set ret_strObject="TSS"
		// Return ret_strObject
		// Function: Get_TSS_LIST
		// Description:
		// Returns
		// FunctionalVar:
		// Parameters
		// Static Variables
		// Local variables
		// Actions
		// Return TSS_LIST
		// Function: SetMethod
		// Description:
		// Returns
		// Parameters
		// String: p_strParam
		// Static Variables
		// Local variables
		// Actions
		// Set Method=p_strParam
		// Function: SetTssId
		// Description:
		// Returns
		// Parameters
		// String: p_strParam
		// Static Variables
		// Local variables
		// Actions
		// Set TssId=p_strParam
		// Function: ParseTssList
		// Protected Function: Yes
		// Description:
		// Returns
		// FunctionalVar:
		// Parameters
		// Static Variables
		// Local variables
		// FunctionalVar: FISKALY_XML=OBJ_Null
		// FunctionalVar: FISKALY_TSSList=OBJ_Null
		// Actions
		// If SalStrLength(ResponseXML)>0
		// Set FISKALY_XML = new FiskalyXML(ResponseXML)
		// Set FISKALY_TSSList = new FiskalyTSSList
		// Set FISKALY_TSSList = FISKALY_XML.ParseTSSList()
		// Return FISKALY_TSSList
		// Else
		// Return OBJ_Null
		// Function: ParseTss
		// Protected Function: Yes
		// Description:
		// Returns
		// FunctionalVar:
		// Parameters
		// Static Variables
		// Local variables
		// FunctionalVar: FISKALY_XML=OBJ_Null
		// FunctionalVar: FISKALY_TSS=OBJ_Null
		// Actions
		// If SalStrLength(ResponseXML)>0
		// Set FISKALY_XML = new FiskalyXML(ResponseXML)
		// Set FISKALY_TSS = new FiskalyTSS
		// Set FISKALY_TSS = FISKALY_XML.ParseTSS()
		// Return FISKALY_TSS
		// Else
		// Return OBJ_Null
		/// <summary>
		/// </summary>
		/// <param name="p_strList"></param>
		/// <param name="p_nMode"></param>
		/// <returns></returns>
		public SalNumber ParseDataFromXML(SalString p_strList, SalNumber p_nMode)
		{
			#region Local Variables
			FiskalyXML FISKALY_XML = new FiskalyXML();
			#endregion
			
			#region Actions
			if (Fiskaly.RESPONSE_XML.Length > 0) 
			{
				// Task: constructor not in 6.2
				// Inserted: 2020-01-16-09.53
				// Created by: Olaf
				// A Constructor with matching parameter list was not found
				// Set FISKALY_XML = new FiskalyXML(ResponseXML)
				FISKALY_XML = new FiskalyXML();
				FISKALY_XML.SetXML(Fiskaly.RESPONSE_XML);
                if (FISKALY_XML.ParseObjects(p_strList, p_nMode)) 
				{
					if (p_nMode == 0) 
					{
						if (p_strList == "Fiskaly_Client") 
						{
							Fiskaly.CLIENT_LIST = FISKALY_XML.FISKALY_CLIENT_LIST;
						}
						if (p_strList == "Fiskaly_TSS") 
						{
							Fiskaly.TSS_LIST = FISKALY_XML.FISKALY_TSS_LIST;
						}
						if (p_strList == "Fiskaly_Transaction") 
						{
							Fiskaly.TRANSACTION_LIST = FISKALY_XML.FISKALY_TRANSACTION_LIST;
						}
						if (p_strList == "Fiskaly_Export") 
						{
							Fiskaly.EXPORT_LIST = FISKALY_XML.FISKALY_EXPORT_LIST;
						}
						if (p_strList == "Fiskaly_Client_V2") 
						{
							Fiskaly.CLIENT_LIST_V2 = FISKALY_XML.FISKALY_CLIENT_LIST_V2;
						}
						if (p_strList == "Fiskaly_TSS_V2") 
						{
							Fiskaly.TSS_LIST_V2 = FISKALY_XML.FISKALY_TSS_LIST_V2;
						}
						if (p_strList == "Fiskaly_Transaction_V2") 
						{
							Fiskaly.TRANSACTION_LIST_V2 = FISKALY_XML.FISKALY_TRANSACTION_LIST_V2;
						}
						if (p_strList == "Fiskaly_Export_V2") 
						{
							Fiskaly.EXPORT_LIST_V2 = FISKALY_XML.FISKALY_EXPORT_LIST_V2;
						}
					}
					else
					{
						if (p_strList == "Fiskaly_Client") 
						{
							Fiskaly.CLIENT = FISKALY_XML.FISKALY_CLIENT;
						}
						else if (p_strList == "Fiskaly_TSS") 
						{
							Fiskaly.TSS = FISKALY_XML.FISKALY_TSS;
						}
						else if (p_strList == "Fiskaly_Transaction") 
						{
							Fiskaly.TRANSACTION = FISKALY_XML.FISKALY_TRANSACTION;
						}
						else if (p_strList == "Fiskaly_Export") 
						{
							Fiskaly.EXPORT = FISKALY_XML.FISKALY_EXPORT;
						}
						// -- GeÃ¤ndert (24.10.2021)
						else if (p_strList == "Fiskaly_TSS_V2") 
						{
							Fiskaly.TSS_V2 = FISKALY_XML.FISKALY_TSS_V2;
						}
						else if (p_strList == "Fiskaly_Client_V2") 
						{
							Fiskaly.CLIENT_V2 = FISKALY_XML.FISKALY_CLIENT_V2;
						}
						else if (p_strList == "Fiskaly_Transaction_V2") 
						{
							Fiskaly.TRANSACTION_V2 = FISKALY_XML.FISKALY_TRANSACTION_V2;
						}
						else if (p_strList == "Fiskaly_Export_V2") 
						{
							Fiskaly.EXPORT_V2 = FISKALY_XML.FISKALY_EXPORT_V2;
						}
					}
				}
				FISKALY_XML = null;
			}

			return 0;
			#endregion
		}
		// - Set Methoden
		/// <summary>
		/// </summary>
		/// <param name="p_strTssId"></param>
		/// <returns></returns>
		public SalNumber SetTSS_ID(SalString p_strTssId)
		{
			#region Actions
			Fiskaly.TSS_ID = p_strTssId;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strClientId"></param>
		/// <returns></returns>
		public SalNumber SetCLIENT_ID(SalString p_strClientId)
		{
			#region Actions
			Fiskaly.CLIENT_ID = p_strClientId;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strTxId"></param>
		/// <returns></returns>
		public SalNumber SetTX_ID(SalString p_strTxId)
		{
			#region Actions
			Fiskaly.TX_ID = p_strTxId;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strExportId"></param>
		/// <returns></returns>
		public SalNumber SetEXPORT_ID(SalString p_strExportId)
		{
			#region Actions
			Fiskaly.EXPORT_ID = p_strExportId;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strSerialNumber"></param>
		/// <returns></returns>
		public SalNumber SetSERIAL_NUMBER(SalString p_strSerialNumber)
		{
			#region Actions
			Fiskaly.SERIAL_NUMBER = p_strSerialNumber;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_nRevision"></param>
		/// <returns></returns>
		public SalNumber SetREVISION(SalNumber p_nRevision)
		{
			#region Actions
			Fiskaly.LASTREVISION = p_nRevision;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strState"></param>
		/// <returns></returns>
		public SalNumber SetSTATE(SalString p_strState)
		{
			#region Actions
			Fiskaly.STATE = p_strState;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strDesc"></param>
		/// <returns></returns>
		public SalNumber SetDESCRIPTION(SalString p_strDesc)
		{
			#region Actions
			Fiskaly.DESCRIPTION = p_strDesc;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strAdminpin"></param>
		/// <returns></returns>
		public SalNumber SetADMIN_PIN(SalString p_strAdminpin)
		{
			#region Actions
			Fiskaly.ADMIN_PIN = p_strAdminpin;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strProcessType"></param>
		/// <returns></returns>
		public SalNumber SetPROCESS_TYPE(SalString p_strProcessType)
		{
			#region Actions
			Fiskaly.PROCESS_TYPE = p_strProcessType;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strProcessData"></param>
		/// <returns></returns>
		public SalNumber SetPROCESS_DATA(SalString p_strProcessData)
		{
			#region Actions
			Fiskaly.PROCESS_DATA = p_strProcessData;

			return 0;
			#endregion
		}
		// -- GeÃ¤ndert (13.07.2021)
		/// <summary>
		/// </summary>
		/// <param name="p_strStartDate"></param>
		/// <returns></returns>
		public SalNumber SetSTART_DATE(SalString p_strStartDate)
		{
			#region Actions
			Fiskaly.START_DATE = p_strStartDate;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strEndDate"></param>
		/// <returns></returns>
		public SalNumber SetEND_DATE(SalString p_strEndDate)
		{
			#region Actions
			Fiskaly.END_DATE = p_strEndDate;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strUrl"></param>
		/// <returns></returns>
		public SalNumber SetURL_DOWNLOAD(SalString p_strUrl)
		{
			#region Actions
			Fiskaly.URL_DOWNLOAD = p_strUrl;

			return 0;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_strFile"></param>
		/// <returns></returns>
		public SalNumber SetFILE_DOWNLOAD(SalString p_strFile)
		{
			#region Actions
			Fiskaly.FILE_DOWNLOAD = p_strFile;

			return 0;
			#endregion
		}
		// - Get Methoden
		/// <summary>
		/// </summary>
		/// <returns></returns>
		public SalString GetXML()
		{
			#region Actions
			return Fiskaly.RESPONSE_XML;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <returns></returns>
		public SalString GetCONTENT()
		{
			#region Actions
			return Fiskaly.RESPONSE_CONTENT;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <returns></returns>
		public SalString GetERROR()
		{
			#region Actions
			return Fiskaly.RESPONSE_ERROR;
			#endregion
		}
		
		/// <summary>
		/// </summary>
		/// <param name="p_nTimestamp"></param>
		/// <returns></returns>
		public SalString GetDateFromTimestamp(SalNumber p_nTimestamp)
		{
			#region Local Variables
			SalDateTime dTimestampDate = SalDateTime.Null;
			#endregion
			
			#region Actions
			// Task: ohne DLL
			// Inserted: 2020-08-25-15.08
			// Symbol is undefined or unable to be referenced from current location: FISKALY_DATE
			// Call FISKALY_DATE.FiskalyTimeStamp( p_nTimestamp )
			// Return FISKALY_DATE.Timestamp2DateToString(  )
			p_nTimestamp = p_nTimestamp / 60;
			p_nTimestamp = p_nTimestamp / 60;
			p_nTimestamp = p_nTimestamp + 2;
			p_nTimestamp = p_nTimestamp / 24;
			dTimestampDate = new SalDateTime(1970, 1, 1, 0, 0, 0);
			dTimestampDate = dTimestampDate + p_nTimestamp;
			return dTimestampDate.ToString("dd.MM.yyyy hhhh:mm");
			#endregion
		}
		#endregion
	}
}
