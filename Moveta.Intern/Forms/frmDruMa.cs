// <ppj name="Moveta.Intern" date="1/17/2024 7:59:41 AM" id="F4EC85BAD2BF79AC25C9F8643540E90F9BE1DAF0"/>
// ======================================================================================================
// This code was generated by the Ice Porter(tm) Tool version 4.8.15.0
// Ice Porter is part of The Porting Project (PPJ) by Ice Tea Group, LLC.
// The generated code is not guaranteed to be accurate and to compile without
// manual modifications.
// 
// ICE TEA GROUP LLC SHALL IN NO EVENT BE LIABLE FOR ANY DAMAGES WHATSOEVER
// (INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS OF BUSINESS PROFITS, BUSINESS
// INTERRUPTION, LOSS OF BUSINESS INFORMATION, OR ANY OTHER LOSS OF ANY KIND)
// ARISING OUT OF THE USE OR INABILITY TO USE THE GENERATED CODE, WHETHER
// DIRECT, INDIRECT, INCIDENTAL, CONSEQUENTIAL, SPECIAL OR OTHERWISE, REGARDLESS
// OF THE FORM OF ACTION, EVEN IF ICE TEA GROUP LLC HAS BEEN ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGES.
// =====================================================================================================
using System;
using System.Text;
using System.Drawing;
using System.Diagnostics;
using System.Collections;
using System.Windows.Forms;
using System.ComponentModel;
using MT;
using PPJ.Runtime;
using PPJ.Runtime.Com;
using PPJ.Runtime.Sql;
using PPJ.Runtime.Vis;
using PPJ.Runtime.Windows;
using PPJ.Runtime.Windows.QO;
using PPJ.Runtime.XSal;

namespace Moveta.Intern
{
	
	/// <summary>
	/// Mahnungsdruck
	/// </summary>
	public partial class frmDruMa : SalFormWindow
	{
		#region Window Variables
		public SalSqlHandle hSqlMV = SalSqlHandle.Null;
		public SalString strSelect = "";
		public SalNumber nFetchMV = 0;
		public SalSqlHandle hSqlOR = SalSqlHandle.Null;
		public SalString strSelectOR = "";
		public SalNumber nFetchOR = 0;
		public SalNumber nArztNr = 0;
		public SalNumber nArztNrAlt = 0;
		public SalNumber nHalterNr = 0;
		public SalNumber nHalterNrAlt = 0;
		public SalString strHN1 = "";
		public SalString strHN1Alt = "";
		public SalNumber nRechNr = 0;
		public SalBoolean bExists = false;
		public SalBoolean bOffRech = false;
		public SalBoolean bZinsen = false;
		public SalBoolean bRaten = false;
		public SalDateTime dtRechDat = SalDateTime.Null;
		public SalNumber nSeite = 0;
		public SalNumber nZeile = 0;
		public SalNumber nRechZaehl = 0;
		public SalString strDrucker = "";
		public SalNumber nMS = 0;
		public SalNumber nDMRest = 0;
		public SalNumber nDMOP = 0;
		public SalNumber nMZFRechNr = 0;
		public SalNumber nMZFMS = 0;
		public SalArray<SalString> strMT1 = new SalArray<SalString>("1:6");
		public SalArray<SalString> strMT2 = new SalArray<SalString>("1:6");
		public SalArray<SalNumber> nMI = new SalArray<SalNumber>("1:3");
		public SalArray<SalNumber> nMG = new SalArray<SalNumber>("1:3");
		public SalNumber nGesBrutto = 0;
		public SalNumber nGesMahnDM = 0;
		public SalNumber nORRechNr = 0;
		public SalDateTime dtORRechDat = SalDateTime.Null;
		public SalNumber nORDMRest = 0;
		public SalArray<SalNumber> nZIProz = new SalArray<SalNumber>("1:3");
		public SalNumber nZIZaAnz = 0;
		public SalNumber nZIZaGes = 0;
		public SalNumber nGesZinsen = 0;
		public SalSqlHandle hSqlZI = SalSqlHandle.Null;
		public SalString strSelectZI = "";
		public SalNumber nFetchZI = 0;
		public SalNumber nZIRechGes = 0;
		public SalNumber nZIZahlGes = 0;
		public SalNumber nZIZinsAlt = 0;
		public SalDateTime dtZIRechDat = SalDateTime.Null;
		public SalDateTime dtZIZahlDat = SalDateTime.Null;
		public SalNumber nZIZahlDM = 0;
		public SalNumber nZITage = 0;
		public SalNumber nZinsen = 0;
		public SalDateTime dtMahnDat = SalDateTime.Null;
		public SalNumber nMahnGeb = 0;
		public SalString strAN1or = "";
		public SalString strAN2or = "";
		public SalString strASor = "";
		public SalString strAOor = "";
		public SalString strHTor = "";
		public SalString strHN1or = "";
		public SalString strHN2or = "";
		public SalString strHSor = "";
		public SalString strHOor = "";
		public SalDateTime dtRatDat = SalDateTime.Null;
		public SalDateTime dtRat1 = SalDateTime.Null;
		public SalNumber nRatmtl = 0;
		public SalNumber nRatDM = 0;
		public SalString strLogo = "";
		public SalNumber nJob = 0;
		public SalNumber nStatus = 0;
		public SalNumber nError = 0;
		#endregion
		
		#region Constructors/Destructors
		
		/// <summary>
		/// Default Constructor.
		/// </summary>
		public frmDruMa()
		{
			// Assign global reference.
			App.frmDruMa = this;
			// This call is required by the Windows Form Designer.
			InitializeComponent();
		}
		#endregion
		
		#region System Methods/Properties
		
		/// <summary>
		/// Shows the form window.
		/// </summary>
		/// <param name="owner"></param>
		/// <returns></returns>
		public static frmDruMa CreateWindow(Control owner)
		{
			frmDruMa frm = new frmDruMa();
			frm.Show(owner);
			return frm;
		}
		
		/// <summary>
		/// Returns the object instance associated with the window handle.
		/// </summary>
		/// <param name="handle"></param>
		/// <returns></returns>
		[DebuggerStepThrough]
		public static frmDruMa FromHandle(SalWindowHandle handle)
		{
			return ((frmDruMa)SalWindow.FromHandle(handle, typeof(frmDruMa)));
		}
		#endregion
		
		#region Window Actions
		
		/// <summary>
		/// frmDruMa WindowActions Handler
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void frmDruMa_WindowActions(object sender, WindowActionsEventArgs e)
		{
			#region Actions
			switch (e.ActionType)
			{
				case Sys.SAM_Create:
					this.frmDruMa_OnSAM_Create(sender, e);
					break;
			}
			#endregion
		}
		
		/// <summary>
		/// SAM_Create event handler.
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void frmDruMa_OnSAM_Create(object sender, WindowActionsEventArgs e)
		{
			#region Actions
			e.Handled = true;
			// Set dfArztNr=nArztNr
			this.nMI[1] = 14;
			this.nMI[2] = 14;
			this.nMI[3] = 10;
			// 21.11.16 Ä1445
			// 19.03.08
			// Set cbUeberw = TRUE
			this.cbUeberw.Checked = false;

			// Set cbA4 = TRUE
			// 27.12.12 F1493
			this.rbAlles.Checked = true;
			Sal.WaitCursor(false);
			#endregion
		}
		
		/// <summary>
		/// pbFuellen WindowActions Handler
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void pbFuellen_WindowActions(object sender, WindowActionsEventArgs e)
		{
			#region Actions
			switch (e.ActionType)
			{
				case Sys.SAM_Click:
					this.pbFuellen_OnSAM_Click(sender, e);
					break;
			}
			#endregion
		}
		
		/// <summary>
		/// SAM_Click event handler.
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void pbFuellen_OnSAM_Click(object sender, WindowActionsEventArgs e)
		{
			#region Actions
			e.Handled = true;
			Int.SqlConnection(ref this.hSqlMV);
			this.strSelect = "SELECT mddatum FROM md WHERE mddeaktiv IS NULL ";
			// Set strSelect = 'SELECT DISTINCT mddatum FROM md '
			if (!(this.dfArztNr.IsEmpty()) && this.dfArztNr.Number != 0) 
			{
				this.strSelect = this.strSelect + "AND mdarztnr = :frmDruMa.dfArztNr ";
				if (!(this.dfA1von.IsEmpty()) && this.dfA1von.Number != 0) 
				{
					this.strSelect = this.strSelect + "AND mdhalternr = :frmDruMa.dfA1von ";
				}
			}
			this.strSelect = this.strSelect + " GROUP BY 1 ORDER BY mddatum DESC";
			// Set strSelect = strSelect || ' ORDER BY mddatum DESC'
			this.cmbMahnDat.PopulateList(this.hSqlMV, this.strSelect);
			this.hSqlMV.Disconnect();
			#endregion
		}
		
		/// <summary>
		/// pbOk WindowActions Handler
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void pbOk_WindowActions(object sender, WindowActionsEventArgs e)
		{
			#region Actions
			switch (e.ActionType)
			{
				case Sys.SAM_Click:
					this.pbOk_OnSAM_Click(sender, e);
					break;
			}
			#endregion
		}
		
		/// <summary>
		/// SAM_Click event handler.
		/// </summary>
		/// <param name="sender"></param>
		/// <param name="e"></param>
		private void pbOk_OnSAM_Click(object sender, WindowActionsEventArgs e)
		{
			#region Actions
			e.Handled = true;
			// 09.05.17 Ä1544
			if (!(this.cmbMahnDat.IsEmpty()) && ((SalString)this.cmbMahnDat.Text).ToDate() <= new SalDateTime(2017, 4, 25)) 
			{
				Var.strDummy1 = "Mahnung A4 tvn.lst";
			}
			else if (this.dfMDbis.DateTime != Sys.DATETIME_Null && this.dfMDbis.DateTime <= new SalDateTime(2017, 4, 24)) 
			{
				Var.strDummy1 = "Mahnung A4 tvn.lst";
			}
			else
			{
				Var.strDummy1 = "Mahnung A4.lst";
			}
			// XXXXX

			Sal.WaitCursor(false);

			if (this.cmbMahnDat.IsEmpty() && this.dfMDvon.DateTime == Sys.DATETIME_Null && this.dfMDbis.DateTime == Sys.DATETIME_Null) 
			{
				Sal.MessageBox("Bitte erst Mahn-Datum wählen !", "Achtung", Sys.MB_Ok);
				this.cmbMahnDat.SetFocus();
			}
			else if ((this.dfMDvon.DateTime != Sys.DATETIME_Null || this.dfMDbis.DateTime != Sys.DATETIME_Null) && this.dfA1von.Number == Sys.NUMBER_Null) 
			{
				Sal.MessageBox("Für die Option Datum von / bis muß eine Halternummer eingegeben werden. ", "Achtung", Sys.MB_Ok);
				this.dfA1von.SetFocus();
			}
			else
			{
				// 10.02-09 OTÄ170 auskommentiert: Call SalDestroyWindow(hWndForm)
				// LL
				// If cbA4
				if (1 == dlgLlDruck.ModalDialog(App.frmMain, Var.strDummy1, "")) 
				{
					// 18.02.08
					if (this.cbUeberw.Checked) 
					{
						if (1 == dlgLlDruck.ModalDialog(App.frmMain, "MahnUeberw.lst", "")) 
						{
							// Call SalDestroyWindow(hWndForm)
						}
					}
					else
					{
						// Call SalDestroyWindow(hWndForm)
					}
				}
				// Else
				// If 1 = SalModalDialog( dlgLlDruck, frmMain, 'Mahnungen.lst', '' )
				// Call SalDestroyWindow(hWndForm)
			}
			#endregion
		}
		#endregion
	}
}
